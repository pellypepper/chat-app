(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{20604:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(95155);var o=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]},l=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},u=function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var n=e(t),u=0;u<n.length;u++)"default"!==n[u]&&o(r,t,n[u]);return l(r,t),r}}();Object.defineProperty(t,"__esModule",{value:!0}),t.SocketProvider=t.useSocketContext=void 0;let i=u(r(12115)),a=function(e){return e&&e.__esModule?e:{default:e}}(r(22213)),s=(0,i.createContext)({socket:null,socketConnected:!1});t.useSocketContext=()=>(0,i.useContext)(s),t.SocketProvider=e=>{let{userId:t,children:r}=e,[o,l]=(0,i.useState)(!1),u=(0,i.useRef)(null);return(0,i.useEffect)(()=>{if(t)return u.current&&(u.current.disconnect(),u.current=null),u.current=(0,a.default)("http://localhost:4000",{query:{userId:t.toString()},transports:["websocket","polling"],autoConnect:!0,reconnection:!0,reconnectionDelay:1e3,reconnectionAttempts:5,timeout:2e4}),u.current.on("connect",()=>l(!0)),u.current.on("disconnect",()=>l(!1)),u.current.on("connect_error",()=>l(!1)),()=>{u.current&&(u.current.disconnect(),u.current=null)}},[t]),(0,n.jsx)(s.Provider,{value:{socket:u.current,socketConnected:o},children:r})}},22840:(e,t,r)=>{Promise.resolve().then(r.bind(r,76903))},30347:()=>{},66607:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useAuthStore=void 0;let n=r(87657),o=function(e){return e&&e.__esModule?e:{default:e}}(r(43653)),l=r(82127);o.default.defaults.withCredentials=!0,o.default.defaults.baseURL="https://chat-app-tk-blg.fly.dev",t.useAuthStore=(0,n.create)()((0,l.devtools)(e=>({user:null,isAuthenticated:!1,isLoading:!1,error:null,getSession:async()=>{var t,r;try{let r=(await o.default.get("/login/user",{withCredentials:!0})).data.user;e({user:r,isAuthenticated:null==(t=null==r?void 0:r.verified)||t,isLoading:!1,error:null})}catch(t){try{await o.default.post("/login/refresh",{},{withCredentials:!0});let t=(await o.default.get("/login/user",{withCredentials:!0})).data.user;e({user:t,isAuthenticated:null==(r=null==t?void 0:t.verified)||r,isLoading:!1,error:null})}catch(t){e({user:null,isAuthenticated:!1,error:"Session expired"})}}},login:async t=>{var r,n,l,u;let{email:i,password:a}=t;e({isLoading:!0,error:null});try{let t=await o.default.post("/login",{email:i,password:a});e({user:t.data.user,isAuthenticated:null!=(n=null==(r=t.data.user)?void 0:r.verified)&&n})}catch(t){e({error:(null==(u=t.response)||null==(l=u.data)?void 0:l.message)||t.message})}finally{e({isLoading:!1})}},googleLogin:()=>{window.location.href="login/google"},logout:async()=>{e({isLoading:!0,error:null});try{await o.default.post("/login/logout"),e({user:null,isAuthenticated:!1,error:null})}catch(n){var t,r;e({error:(null==(r=n.response)||null==(t=r.data)?void 0:t.message)||n.message})}finally{e({isLoading:!1})}},reset:()=>e({user:null,isLoading:!1,error:null})})))},76903:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n=r(95155);r(30347);var o=r(12115),l=r(20604),u=r(66607);function i(e){let{children:t}=e,[r,i]=(0,o.useState)(!1);(0,o.useMemo)(()=>({isOpen:r,open:()=>i(!0),close:()=>i(!1)}),[r]);let{user:a}=(0,u.useAuthStore)();return(0,n.jsx)("html",{lang:"en",className:"scroll-smooth",children:(0,n.jsx)("body",{children:(0,n.jsx)(l.SocketProvider,{userId:null==a?void 0:a.id,children:t})})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[690,547,213,441,684,358],()=>t(22840)),_N_E=e.O()}]);
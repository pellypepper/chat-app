(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{17484:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(95155);Object.defineProperty(t,"__esModule",{value:!0});let l=r(12115),s=function(e){return e&&e.__esModule?e:{default:e}}(r(66766)),n=r(30497),i=r(99082),o=r(66607);t.default=e=>{let{chat:t,handleClickOutside:r}=e,[d,c]=(0,l.useState)(!1),[u,f]=(0,l.useState)(null),m=t.name.split(" ").map(e=>e[0]).join("").toUpperCase(),{user:x}=(0,o.useAuthStore)(),{fetchFriendDetails:g}=(0,i.useFriendsStore)(),h=t.participants.find(e=>e!==(null==x?void 0:x.id));return((0,l.useEffect)(()=>{(async()=>{if(h)try{let e=await g(h);f(e)}catch(e){console.error("Failed to fetch friend details",e)}})()},[h]),u)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{onClick:r,className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{backgroundColor:"rgba(13, 17, 23, 0.8)"},children:(0,a.jsxs)("div",{className:"relative w-auto bg-navbar-bg border-primary border max-w-md p-4 backdrop-blur-sm rounded-lg shadow-lg flex flex-col items-center",children:[(0,a.jsx)("div",{className:"w-20 h-20 mx-auto rounded-full overflow-hidden cursor-pointer border-2 border-blue-400 relative",onClick:()=>c(!0),children:u.profilePicture?(0,a.jsx)(s.default,{src:u.profilePicture,alt:u.firstname,width:80,height:80,className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-r from-purple-500 to-pink-500 text-white text-2xl font-bold",children:m})}),(0,a.jsxs)("div",{className:"mt-2 text-white text-sm font-semibold",children:[u.firstname," ",u.lastname]}),(0,a.jsx)("div",{className:"mt-1 text-gray-400 text-sm",children:u.email})]})}),(0,a.jsxs)(n.Dialog,{open:d,onClose:()=>c(!1),className:"relative z-50",children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black/70","aria-hidden":"true"}),(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,a.jsxs)(n.Dialog.Panel,{className:"bg-[#0d1117] p-4 rounded-lg border border-primary max-w-md w-full",children:[(0,a.jsx)("div",{className:"text-right mb-2",children:(0,a.jsx)("button",{onClick:()=>c(!1),className:"text-sm text-gray-400 hover:text-white",children:"Close"})}),u.profilePicture?(0,a.jsx)(s.default,{src:u.profilePicture,alt:"".concat(u.firstname,"'s profile"),width:400,height:400,className:"w-full h-auto rounded"}):(0,a.jsx)("div",{className:"w-full h-64 flex items-center justify-center bg-gradient-to-r from-purple-500 to-pink-500 text-white text-4xl font-bold rounded",children:m})]})})]})]}):null}},20604:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(95155);var l=Object.create?function(e,t,r,a){void 0===a&&(a=r);var l=Object.getOwnPropertyDescriptor(t,r);(!l||("get"in l?!t.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,l)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]},s=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},n=function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var a=e(t),n=0;n<a.length;n++)"default"!==a[n]&&l(r,t,a[n]);return s(r,t),r}}();Object.defineProperty(t,"__esModule",{value:!0}),t.SocketProvider=t.useSocketContext=void 0;let i=n(r(12115)),o=function(e){return e&&e.__esModule?e:{default:e}}(r(22213)),d=(0,i.createContext)({socket:null,socketConnected:!1});t.useSocketContext=()=>(0,i.useContext)(d),t.SocketProvider=e=>{let{userId:t,children:r}=e,[l,s]=(0,i.useState)(!1),n=(0,i.useRef)(null);return(0,i.useEffect)(()=>{if(t)return n.current&&(n.current.disconnect(),n.current=null),n.current=(0,o.default)("http://localhost:4000",{query:{userId:t.toString()},transports:["websocket","polling"],autoConnect:!0,reconnection:!0,reconnectionDelay:1e3,reconnectionAttempts:5,timeout:2e4}),n.current.on("connect",()=>s(!0)),n.current.on("disconnect",()=>s(!1)),n.current.on("connect_error",()=>s(!1)),()=>{n.current&&(n.current.disconnect(),n.current=null)}},[t]),(0,a.jsx)(d.Provider,{value:{socket:n.current,socketConnected:l},children:r})}},22481:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(95155);Object.defineProperty(t,"__esModule",{value:!0});let l=r(89869),s=function(e){return e&&e.__esModule?e:{default:e}}(r(66766));t.default=e=>{var t,r,n,i;let{user:o,onMessage:d,onAdd:c,onRemove:u,isFriend:f,status:m}=e,x="".concat(((null==o||null==(r=o.firstname)||null==(t=r[0])?void 0:t.toUpperCase())||"")+((null==o||null==(i=o.lastname)||null==(n=i[0])?void 0:n.toUpperCase())||""));return(0,a.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-800/50 rounded-xl hover:bg-gray-800/70 transition-colors",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-purple rounded-full flex items-center justify-center text-primary font-semibold",children:o.profilePicture?(0,a.jsx)(s.default,{width:80,height:80,src:o.profilePicture,alt:"Profile",className:"w-full h-full rounded-full object-cover"}):x}),(0,a.jsx)("div",{className:"absolute bottom-0 right-0 w-3 h-3 ".concat((0,l.getStatusColor)(m)," border-2 border-primary rounded-full")})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,a.jsx)("div",{className:"font-semibold text-primary",children:o.firstname}),(0,a.jsx)("div",{className:"flex flex-col gap-2",children:f?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>null==d?void 0:d(o.id),className:"px-3 py-1 bg-[#58a6ff] text-primary  rounded-lg hover:bg-blue-700 transition-colors text-xs",children:"Message"}),u&&(0,a.jsx)("button",{onClick:()=>u(o.id),className:"px-3 py-1 bg-red-600/20 text-red-400 rounded-lg hover:bg-red-600/30 transition-colors text-xs",children:"Remove"})]}):c&&(0,a.jsx)("button",{onClick:()=>c(o.id),className:"px-3 py-1 bg-green-600 text-primary rounded-lg hover:bg-green-700 transition-colors text-xs",children:"Add Friend"})})]})]})}},24679:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(95155);Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>{let{activeTab:t,onTabChange:r}=e,l=e=>"px-4 py-2 rounded-t-xl rounded-bl-xl cursor-pointer transition-colors duration-200 text-primary ".concat(t===e?"bg-gradient-purple":"bg-grey hover:bg-[#21262d]");return(0,a.jsx)("nav",{className:"bg-[#0d1117] border-b border-primary text-sm md:text-base",children:(0,a.jsxs)("ul",{className:"flex justify-between items-center px-3 py-2 gap-2",children:[(0,a.jsx)("li",{onClick:()=>r("all"),className:l("all"),children:"All Users"}),(0,a.jsx)("li",{onClick:()=>r("online"),className:l("online"),children:"Online Friends"}),(0,a.jsx)("li",{onClick:()=>r("friends"),className:l("friends"),children:"My Friends"})]})})}},25819:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(95155);Object.defineProperty(t,"__esModule",{value:!0});let l=function(e){return e&&e.__esModule?e:{default:e}}(r(66766));t.default=e=>{let{conversations:t,onChatSelect:r}=e;return(0,a.jsx)("div",{className:"",children:(0,a.jsx)("div",{className:"flex-1 overflow-x-hidden",children:t.map(e=>{var t,s,n;let i=null!=(n=null==e||null==(s=e.name)||null==(t=s[0])?void 0:t.toUpperCase())?n:"?";return(0,a.jsxs)("div",{onClick:()=>r(e.id),className:"flex p-4 justify-between items-center border-b border-gray-600 gap-3 hover:bg-gray-700/30 cursor-pointer transition-all duration-200 ".concat(e.active?"bg-gray-700/50 border-r-4 border-blue-400":""),children:[(0,a.jsxs)("div",{className:"relative w-[45px] h-[45px] rounded-full bg-gradient-purple text-primary flex items-center justify-center font-semibold text-base",children:[e.avatar?(0,a.jsx)(l.default,{width:80,height:80,src:e.avatar,alt:"Profile",className:"w-full h-full rounded-full object-cover"}):i,e.online&&(0,a.jsx)("span",{className:"absolute bottom-0 right-0 w-3 h-3 bg-green-500 border-2 border-primary rounded-full"})]}),(0,a.jsxs)("div",{className:"flex-1 w-[200px]",children:[(0,a.jsx)("div",{className:"font-semibold text-primary",children:e.name}),(0,a.jsx)("div",{className:"text-sm text-gray-400 truncate",children:e.message})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-1 text-xs",children:[(0,a.jsx)("span",{className:"text-gray-400",children:e.time?new Date(e.time).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"}):""}),e.unread>0&&(0,a.jsx)("span",{className:"bg-gradient-orange text-primary font-bold w-5 h-5 flex items-center justify-center rounded-full text-xs",children:e.unread})]})]},e.id)})})})}},26691:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(95155);Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>{let{size:t=24,color:r="currentColor"}=e;return(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:r,width:t,height:t,className:"cursor-pointer",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a4 4 0 00-4-4h-1m-8 6h5v-2a4 4 0 00-4-4H7m6-6a4 4 0 11-8 0 4 4 0 018 0zm6 0a4 4 0 11-8 0 4 4 0 018 0z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v8m4-4H8"})]})}},30862:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(95155);var l=Object.create?function(e,t,r,a){void 0===a&&(a=r);var l=Object.getOwnPropertyDescriptor(t,r);(!l||("get"in l?!t.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,l)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]},s=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},n=function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var a=e(t),n=0;n<a.length;n++)"default"!==a[n]&&l(r,t,a[n]);return s(r,t),r}}(),i=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(r(12115)),d=i(r(42312)),c=i(r(25819)),u=i(r(60040)),f=i(r(26691)),m=r(66607),x=r(35695),g=i(r(84929)),h=i(r(97007)),p=r(92596),b=r(59941);t.default=e=>{var t,r,l,s;let{handleGroup:n,handleClick:i,onChatSelect:v}=e,[y,j]=(0,o.useState)("Messages"),[w,N]=(0,o.useState)(!1),[S,C]=(0,o.useState)(!1),k=(0,x.useRouter)(),{logout:_,isLoading:M,user:O,error:P}=(0,m.useAuthStore)(),{chats:F}=(0,b.useChatStore)(),E=async()=>{try{await _(),N(!0),setTimeout(()=>{k.push("/withNavpages")},2e3)}catch(e){C(!0)}};return(0,a.jsxs)("section",{className:" p-4 h-screen bg-primary-bg flex flex-col",children:[(0,a.jsxs)("div",{className:"flex justify-between p-5 items-center mb-4",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-icon text-primary flex items-center justify-center font-semibold",children:((null==O||null==(r=O.firstname)||null==(t=r[0])?void 0:t.toUpperCase())||"")+((null==O||null==(s=O.lastname)||null==(l=s[0])?void 0:l.toUpperCase())||"")}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("p",{onClick:i,className:"text-primary text-xl md:text-2xl cursor-pointer",children:"⚙️"}),(0,a.jsx)("p",{onClick:E,className:"text-primary text-xl md:text-2xl cursor-pointer",children:"⏻"})]})]}),(0,a.jsx)("nav",{className:"border-b border-primary",children:(0,a.jsx)("ul",{className:"flex justify-between items-center w-full relative",children:["Messages","Friends","Group"].map(e=>(0,a.jsx)("li",{className:"flex-1",children:(0,a.jsxs)("button",{onClick:()=>j(e),className:"w-full p-4 text-center transition-all duration-200 relative ".concat(y===e?"text-primary font-semibold":"text-gray-400 hover:text-gray-300"),children:[e,y===e&&(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-purple rounded-full"})]})},e))})}),(0,a.jsxs)("section",{className:"flex-1 flex flex-col min-h-0",children:["Messages"===y&&(0,a.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,a.jsx)("div",{className:"p-4 flex-shrink-0",children:(0,a.jsx)(d.default,{})}),(0,a.jsx)("div",{className:"flex-1 border-t  border-primary overflow-y-auto scrollbar-auto-hide px-5",children:F.length>0?(0,a.jsx)(c.default,{onChatSelect:v,conversations:F.filter(e=>!e.isGroup).map(e=>{let t=e.participants.find(e=>e.profilePicture);return{id:Number(e.id),name:e.name,avatar:t?t.profilePicture:"",message:e.lastMessage||"",time:e.lastMessageAt||"",unread:0}})}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center mt-16 text-center text-secondary",children:[(0,a.jsxs)("svg",{width:64,height:64,viewBox:"0 0 64 64",fill:"none",className:"mb-4",children:[(0,a.jsx)("circle",{cx:"32",cy:"32",r:"32",fill:"#23272F"}),(0,a.jsx)("path",{d:"M22 28a10 10 0 0 1 20 0v4a10 10 0 0 1-20 0v-4Z",stroke:"#A855F7",strokeWidth:"2"}),(0,a.jsx)("circle",{cx:"26",cy:"32",r:"2",fill:"#58A6FF"}),(0,a.jsx)("circle",{cx:"38",cy:"32",r:"2",fill:"#58A6FF"}),(0,a.jsx)("rect",{x:"28",y:"38",width:"8",height:"2",rx:"1",fill:"#A855F7"})]}),(0,a.jsx)("h2",{className:"text-lg font-semibold text-primary mb-1",children:"No Conversations Yet"}),(0,a.jsx)("p",{className:"text-sm text-secondary max-w-xs",children:"Start a chat with your friends or contacts to see your conversations here."})]})})]}),"Friends"===y&&(0,a.jsx)("div",{className:"p-5",children:(0,a.jsx)(u.default,{onChatSelect:v})}),"Group"===y&&(0,a.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,a.jsx)("div",{className:"p-5 flex-shrink-0",children:(0,a.jsx)("div",{className:"p-2 mt-2 flex justify-center",children:(0,a.jsxs)("button",{onClick:n,className:"flex justify-center items-center gap-2 bg-gradient-purple text-primary font-semibold px-5 py-3 rounded-lg shadow-lg hover:brightness-110 transition duration-300 ease-in-out",children:[(0,a.jsx)(f.default,{size:24,color:"white"}),"Create Group"]})})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto scrollbar-auto-hide px-5",children:F.length>0?(0,a.jsx)(c.default,{onChatSelect:v,conversations:F.filter(e=>e.isGroup).map(e=>({id:Number(e.id),name:e.name,avatar:"",message:e.lastMessage||"",time:e.lastMessageAt||"",unread:0}))}):(0,a.jsxs)("div",{className:"text-center text-gray-400",children:[(0,a.jsx)("p",{className:"text-lg font-semibold",children:"No Groups Available"}),(0,a.jsx)("p",{className:"text-sm",children:"Create or join a group to start chatting!"})]})})]})]}),M&&(0,a.jsx)("div",{className:"fixed inset-0 z-60 flex items-center justify-center bg-black bg-opacity-60",children:(0,a.jsx)(p.MultiRingSpinner,{})}),w&&(0,a.jsx)(g.default,{message:"Logout successful! Redirecting to homepage in 3 seconds...",handleTimeout:()=>{},url:"/withNavpages",tempState:null}),S&&(0,a.jsx)(h.default,{message:P||"Logout failed. Please try again.",handleTimeout:()=>{C(!1)}})]})}},41795:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useProfileStore=void 0;let a=r(87657),l=function(e){return e&&e.__esModule?e:{default:e}}(r(43653)),s=r(82127);l.default.defaults.withCredentials=!0,l.default.defaults.baseURL="https://chat-app-tk-blg.fly.dev",t.useProfileStore=(0,a.create)()((0,s.devtools)(e=>({user:null,isLoading:!1,error:null,message:null,getProfile:async()=>{e({isLoading:!0,error:null,message:null});try{let t=await l.default.get("/profile");e({user:t.data.user,message:null,isLoading:!1})}catch(a){var t,r;e({error:(null==(r=a.response)||null==(t=r.data)?void 0:t.error)||a.message})}finally{e({isLoading:!1})}},updateProfile:async t=>{e({isLoading:!0,error:null,message:null});try{let r=await l.default.put("/profile",t),a=await l.default.get("/profile");e({user:a.data.user,message:r.data.message})}catch(t){var r,a;e({error:(null==(a=t.response)||null==(r=a.data)?void 0:r.error)||t.message})}finally{e({isLoading:!1})}},changePassword:async(t,r)=>{e({isLoading:!0,error:null,message:null});try{let a=await l.default.put("/profile/change-password",{currentPassword:t,newPassword:r});return e({message:a.data.message}),a.data}catch(r){var a,s,n,i;let t=(null==(s=r.response)||null==(a=s.data)?void 0:a.error)||(null==(i=r.response)||null==(n=i.data)?void 0:n.message)||r.message;throw e({error:t}),Error(t)}finally{e({isLoading:!1})}},forgotPassword:async t=>{e({isLoading:!0,error:null,message:null});try{let r=await l.default.post("/profile/forget-password",{email:t});e({message:r.data.message})}catch(t){var r,a;e({error:(null==(a=t.response)||null==(r=a.data)?void 0:r.error)||t.message})}finally{e({isLoading:!1})}},resetPassword:async t=>{let{email:r,token:a,newPassword:s}=t;e({isLoading:!0,error:null,message:null});try{let t=await l.default.post("/profile/reset-password",{email:r,token:a,newPassword:s});e({message:t.data.message})}catch(t){var n,i;e({error:(null==(i=t.response)||null==(n=i.data)?void 0:n.error)||t.message})}finally{e({isLoading:!1})}},uploadProfilePicture:async r=>{e({isLoading:!0,error:null,message:null});let a=new FormData;a.append("image",r);try{let r=await l.default.post("/profile/upload-profile-picture",a,{headers:{"Content-Type":"multipart/form-data"}});e({message:r.data.message}),await t.useProfileStore.getState().getProfile()}catch(t){var s,n;e({error:(null==(n=t.response)||null==(s=n.data)?void 0:s.error)||t.message})}finally{e({isLoading:!1})}},clearState:()=>e({isLoading:!1,error:null,message:null})})))},42312:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(95155);var l=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let s=r(12115),n=r(92599),i=l(r(71183)),o=l(r(66766)),d=r(47937);t.default=()=>{var e;let{stories:t,fetchFriendStories:r,isUploadModalOpen:l,setUploadModalOpen:c,loading:u,error:f,markViewed:m}=(0,n.useStoryStore)(),[x,g]=(0,s.useState)(null),[h,p]=(0,s.useState)(0),[b,v]=(0,s.useState)(0),[y,j]=(0,s.useState)(!1),[w,N]=(0,s.useState)(null);(0,s.useEffect)(()=>{(()=>{let e=localStorage.getItem("userId");N(e?Number(e):null)})()},[]),(0,s.useEffect)(()=>{r()},[r]),(0,s.useEffect)(()=>{if(!x||null===w)return;let e=x.stories[h],r=x.userId===w,a=t.some(e=>e.userId===x.userId);e&&e.id&&!r&&a&&(m(e.id),console.log("Story marked as viewed 1:",e.id))},[x,h,m,w,t]);let S=(0,s.useCallback)(()=>{x&&(h<x.stories.length-1?p(e=>e+1):(g(null),p(0)))},[x,h]);(0,s.useEffect)(()=>{if(!x)return;let e=setInterval(()=>{v(e=>e>=100?(S(),0):e+2)},100);return()=>clearInterval(e)},[x,h,S]),(0,s.useEffect)(()=>{v(0)},[h]);let C=()=>{h>0?p(e=>e-1):(g(null),p(0))},k=(e,t)=>{e/t<.5?C():S()},_=async e=>{await m(e.stories[0].id),g(e),p(0),v(0),j(!1)},M=x&&null!==w&&x.userId===w;return(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-400 mb-3",children:"Stories"}),u&&(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"Loading..."}),f&&(0,a.jsx)("p",{className:"text-red-400 text-sm",children:f}),(0,a.jsxs)("div",{className:"flex gap-5 overflow-x-auto pb-2",children:[(0,a.jsxs)("div",{className:"flex-shrink-0 text-center cursor-pointer group",onClick:()=>c(!0),children:[(0,a.jsx)("div",{className:"w-20 h-20 rounded-full flex items-center justify-center text-2xl mb-1 bg-gradient-to-br from-gray-600 to-gray-700 border-2 border-dashed border-gray-500 group-hover:border-gray-400 transition-all duration-200",children:"\uD83D\uDCF7"}),(0,a.jsx)("p",{className:"text-xs text-gray-400 truncate w-20",children:"Your Story"})]}),null==t?void 0:t.map(e=>{let t=function(e){return e.stories&&0!==e.stories.length?e.stories[e.stories.length-1]:null}(e);return(0,a.jsxs)("div",{className:"flex-shrink-0 text-center cursor-pointer group",onClick:()=>_(e),children:[(0,a.jsx)("div",{className:"w-20 h-20 rounded-full border-secondary border   p-0.5 mb-1 group-hover:scale-105 transition-transform duration-200 relative overflow-hidden",children:t&&"image"===t.type?(0,a.jsx)(o.default,{src:t.content,alt:"Preview",fill:!0,className:"object-cover rounded-full"}):(0,a.jsxs)("div",{className:"w-full h-full rounded-full bg-gray-800 flex items-center justify-center text-2xl relative",children:["\uD83D\uDC64",t&&"text"===t.type&&(0,a.jsx)("span",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 text-xs text-white/80 bg-black/60 px-2 rounded",children:t.content.length>12?t.content.slice(0,12)+"...":t.content})]})}),(0,a.jsxs)("p",{className:"text-xs text-gray-400 truncate w-20 group-hover:text-gray-300 transition-colors",children:[e.firstname," ",e.lastname]})]},"story-".concat(e.userId))})]}),x&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black z-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"relative w-full h-full max-w-md mx-auto bg-black",children:[(0,a.jsx)("div",{className:"absolute top-4 left-4 right-4 z-10 flex gap-1",children:x.stories.map((e,t)=>(0,a.jsx)("div",{className:"flex-1 h-1 bg-white/30 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-white rounded-full transition-all duration-100 ease-linear",style:{width:t<h?"100%":t===h?"".concat(b,"%"):"0%"}})},t))}),(0,a.jsxs)("div",{className:"absolute top-8 left-4 right-4 z-10 flex items-center justify-between pt-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 p-0.5",children:(0,a.jsx)("div",{className:"w-full h-full rounded-full bg-gray-800 flex items-center justify-center text-sm",children:"\uD83D\uDC64"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-white font-medium text-sm",children:[x.firstname," ",x.lastname]}),(0,a.jsx)("p",{className:"text-white/70 text-xs",children:new Date(null==(e=x.stories[h])?void 0:e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]}),(0,a.jsx)("button",{className:"text-white/80 hover:text-white p-2 hover:bg-white/10 rounded-full transition-all",onClick:()=>g(null),children:(0,a.jsx)(d.X,{size:20})})]}),(0,a.jsxs)("div",{className:"w-full h-full flex items-center justify-center cursor-pointer relative",onClick:e=>{let t=e.currentTarget.getBoundingClientRect();k(e.clientX-t.left,t.width)},children:[(0,a.jsxs)("div",{className:"absolute inset-0 flex",children:[(0,a.jsx)("div",{className:"w-1/2 h-full"}),(0,a.jsx)("div",{className:"w-1/2 h-full"})]}),(()=>{let e=x.stories[h];return e?"text"===e.type?(0,a.jsx)("div",{className:"flex items-center justify-center h-full px-8",children:(0,a.jsx)("p",{className:"text-white text-xl text-center leading-relaxed font-medium",children:e.content})}):(0,a.jsx)("div",{className:"relative w-full h-full",children:(0,a.jsx)(o.default,{src:e.content,fill:!0,alt:"Story",className:"object-cover",priority:!0})}):null})()]}),!M&&(0,a.jsx)("div",{className:"absolute bottom-4 left-4 right-4 z-10",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsx)("button",{onClick:C,disabled:0===h,className:"text-white/80 hover:text-white disabled:text-white/30 p-2 hover:bg-white/10 rounded-full transition-all disabled:cursor-not-allowed",children:(0,a.jsx)(d.ChevronLeft,{size:20})})})})})]})}),l&&(0,a.jsx)(i.default,{})]})}},42985:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(95155);Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>{let{value:t,onChange:r}=e;return(0,a.jsx)("div",{className:"px-5 pb-5",children:(0,a.jsx)("input",{className:"w-full px-4 py-3 bg-tertiary-bg border text-primary border-primary mt-3 h-[50px] rounded text-sm focus:outline-none focus:border-[#58a6ff] focus:ring-4 focus:ring-[#58a6ff]/20",type:"text",value:t,onChange:e=>r(e.target.value),placeholder:"Search friends by name or email"})})}},44879:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var a=r(95155),l=r(12115),s=r(59941),n=r(66607),i=r(99082),o=r(92596),d=r(89578),c=r(49966),u=r(93019);let f=()=>{let[e,t]=(0,l.useState)(!1),[r,f]=(0,l.useState)(null),[m,x]=(0,l.useState)(!1),[g,h]=(0,l.useState)(!1),[p,b]=(0,l.useState)(!1),[v,y]=(0,l.useState)(null),{isAuthenticated:j,getSession:w}=(0,n.useAuthStore)(),{chats:N,fetchChatsSummary:S}=(0,s.useChatStore)(),[C,k]=(0,l.useState)(!0),[_,M]=(0,l.useState)("redirecting"),{fetchFriends:O,fetchOnlineFriends:P,fetchAllUsers:F}=(0,i.useFriendsStore)();(0,l.useEffect)(()=>{(async()=>{await w()})()},[w]),(0,l.useEffect)(()=>{if(j){M("redirecting");let e=setTimeout(()=>{M("authenticating")},2500),t=setTimeout(()=>{k(!1)},5e3);return()=>{clearTimeout(e),clearTimeout(t)}}k(!1)},[j]),(0,l.useEffect)(()=>{F(),O(),S(),P()},[F,O,P,S]);let E=()=>t(!0),A=async(e,t)=>{var r,a;if(t)return void f(t);let l=N.find(t=>Number(t.id)===e)||null;if(!l||!Array.isArray(l.participants))return void f(null);f({...l,participants:l.participants.map(e=>{var t;return{id:e.id,name:null!=(t=e.name)?t:""}}),lastMessage:null!=(r=l.lastMessage)?r:void 0,lastMessageAt:null!=(a=l.lastMessageAt)?a:void 0})},L=()=>{x(!m)},D=e=>{(null==e?void 0:e.isGroup)?(y(e),h(!g)):(b(!p),y(e))},U=()=>f(null);return C?(0,a.jsxs)("div",{className:"h-screen bg-navbar-bg flex flex-col justify-center items-center gap-4 ",children:[(0,a.jsx)(o.MultiRingSpinner,{}),(0,a.jsx)("p",{className:"text-lg font-semibold text-primary",children:"redirecting"===_?"redirecting...":"Authenticating..."}),(0,a.jsx)("div",{className:"w-64 h-2 bg-gray-300 rounded-full overflow-hidden mt-2",children:(0,a.jsx)("div",{className:"h-full bg-gradient-to-r from-blue-400 to-purple-600 animate-progressBar",style:{animationDuration:"5s"}})})]}):(0,a.jsxs)("div",{className:"h-screen overflow-hidden ",children:[(0,a.jsx)(d.A,{selectedChat:r,handleUpdateOpen:D,handleBack:U,handleGroup:L,handleChatSelect:A,handleClick:E}),(0,a.jsx)(c.A,{selectedChat:r,handleUpdateOpen:D,handleBack:U,handleGroup:L,handleChatSelect:A,handleClick:E}),(0,a.jsx)(u.A,{isOpen:e,handleClose:()=>t(!1),showCreateGroup:m,handleClickOutside:()=>{x(!1),h(!1),b(!1)},showUpdateGroup:g,updateGroupChat:v,handleGroupUpdated:e=>{f(t=>t&&t.id===e.id?{...t,name:e.name,participants:e.participants.map(e=>t.participants.find(t=>t.id===e)||{id:e,name:""})}:t)},showFriendProfile:p})]})}},48125:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(95155);Object.defineProperty(t,"__esModule",{value:!0});let l=r(59941),s=r(66607),n=r(99082),i=r(12115),o=function(e){return e&&e.__esModule?e:{default:e}}(r(66766)),d=r(20604),c=r(47937);t.default=e=>{var t,r,u;let{chat:f,handleUpdateOpen:m,onBack:x}=e,{fetchMessages:g,messages:h,fetchChatsSummary:p,sendMessage:b,deleteChatEveryone:v,deleteMessageEveryone:y}=(0,l.useChatStore)(),j=(0,s.useAuthStore)(e=>e.user),w=null==j?void 0:j.id,{onlineFriends:N,getUserSeen:S}=(0,n.useFriendsStore)(),{socket:C}=(0,d.useSocketContext)(),k=(0,i.useMemo)(()=>f&&h[f.id]||[],[f,h]),_=(0,i.useRef)(null),[M,O]=(0,i.useState)(""),[P,F]=(0,i.useState)(null),[E,A]=(0,i.useState)(!1),[L,D]=(0,i.useState)(null),U=f&&f.participants&&2===f.participants.length&&w?null==(t=f.participants.find(e=>e.id!==w))?void 0:t.id:null;(0,i.useEffect)(()=>{if(!C||!(null==f?void 0:f.id))return;let e=e=>{let{message:t}=e;t&&f&&t.chatId===f.id&&g(f.id)};return C.on("new_message",e),C.emit("join_chat",f.id),g(f.id),()=>{C.emit("leave_chat",f.id),C.off("new_message",e)}},[f,g,C]),(0,i.useEffect)(()=>{var e;null==(e=_.current)||e.scrollIntoView({behavior:"smooth"})},[k,f]);let[z,R]=(0,i.useState)("Offline"),[T,G]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let e=!0;return async function(){if(f&&f.participants&&2===f.participants.length&&U){let r=N.includes(U);if(G(r),r)R("Active now"),D(null);else try{let r=await S(U);if(e){var t;D(null!=(t=null==r?void 0:r.lastSeen)?t:null),R((null==r?void 0:r.lastSeen)?"Last seen: ".concat(function(e){if(!e)return"";let t=new Date(e),r=new Date().getTime()-t.getTime();return r<6e4?"just now":r<36e5?"".concat(Math.floor(r/6e4)," min ago"):r<864e5?"".concat(Math.floor(r/36e5)," hours ago"):t.toLocaleString()}(r.lastSeen)):"Offline")}}catch(t){e&&(D(null),R("Offline"))}}else f&&f.participants&&f.participants.length>2?(D(null),R(""),G(!1)):(R("Connecting..."),D(null))}(),()=>{e=!1}},[f,N,S,w,U]);let I=async()=>{if((M.trim()||P)&&f){A(!0);try{await b(f.id,M.trim()?M:void 0,P||void 0),await p(),O(""),F(null)}catch(e){}finally{A(!1)}}},B=async(e,t)=>{if(e&&t)try{await y(e,t)}catch(e){}},H=async e=>{if(e)try{await v(e),x()}catch(e){}},V=e=>{m(e)},W=e=>!!e&&"string"==typeof e&&(!!(e.includes("pelly-chat.s3.")&&/\.(jpg|jpeg|png|gif|webp)$/i.test(e))||/\.(jpg|jpeg|png|gif|webp)(\?.*)?$/i.test(e)),Y=(0,a.jsx)("div",{className:"absolute bottom-0 right-0 w-2 h-2 rounded-full border border-white ".concat(T?"bg-green-500":"bg-gray-400")}),X={};return f&&f.participants&&f.participants.length>2&&f.participants.forEach(e=>{e.id!==w&&(X[e.id]=N.includes(e.id)?"online":"offline")}),(0,a.jsx)("div",{className:"p-4 ",children:(0,a.jsx)("div",{className:"flex flex-col flex-1 h-screen",children:f?(0,a.jsxs)("div",{className:"flex flex-col flex-1 h-screen",children:[(0,a.jsxs)("div",{className:"p-5 border-b border-primary flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("button",{onClick:x,className:"md:hidden text-xs text-primary mb-4",children:(0,a.jsx)(c.ArrowLeft,{className:"w-5 h-5 text-primary "})}),(0,a.jsxs)("div",{className:"relative w-8 h-8 rounded-full bg-gradient-purple flex items-center justify-center text-primary text-xs font-semibold",children:[null!=(u=null==f||null==(r=f.name)?void 0:r[0])?u:"?",f&&f.participants&&2===f.participants.length&&Y]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"mb-1 font-semibold text-primary",children:f?f.name:""}),(0,a.jsx)("div",{className:"text-secondary text-sm flex items-center gap-2",children:f&&f.participants&&2===f.participants.length?(0,a.jsxs)(a.Fragment,{children:[T?(0,a.jsx)("span",{className:"text-green-500",children:"Online"}):(0,a.jsx)("span",{className:"text-gray-400",children:z}),L&&!T&&(0,a.jsx)("span",{className:"text-xs text-gray-500"})]}):f&&f.participants&&f.participants.length>2?(0,a.jsx)("span",{className:"text-gray-400",children:"Group Chat"}):""})]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:()=>V(f),className:"w-10 h-10 rounded-full bg-tertiary-bg hover:bg-primary  text-secondary hover:text-primary flex items-center justify-center transition",children:"ℹ️"}),(0,a.jsx)("button",{className:"w-10 h-10 rounded-full bg-red-600 hover:bg-red-800 text-white flex items-center justify-center transition",title:"Delete Chat",onClick:()=>{(null==f?void 0:f.id)!==void 0&&H(f.id)},children:"\uD83D\uDDD1️"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-4 p-5 overflow-y-auto flex-1 scrollbar-hidden",children:[0===k.length&&(0,a.jsx)("div",{className:"text-secondary text-center mt-10",children:"No messages yet."}),k.map((e,t)=>{var r,l,s;let n=e.senderId===w,i="image"===e.type||W(e.content),d=null==f||null==(r=f.participants)?void 0:r.find(t=>t.id===e.senderId),c=n?(null==j?void 0:j.firstname)||"You":(null==d?void 0:d.name)||"Unknown",u=n?(null==j||null==(l=j.firstname)?void 0:l[0])||"Y":(null==d||null==(s=d.name)?void 0:s[0])||"U",m=null;return f&&f.participants&&f.participants.length>2&&d&&d.id!==w&&(m="online"===X[d.id]?"Online":"Offline"),(0,a.jsxs)("div",{className:"flex gap-3 max-w-[70%] ".concat(n?"self-start flex-row":"self-end flex-row-reverse"),children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-semibold \n                  ".concat(n?"bg-gradient-to-br from-[#58a6ff] to-[#a855f7]":"bg-gradient-to-br from-[#6366f1] to-[#8b5cf6]"," flex-shrink-0"),children:u}),(0,a.jsxs)("div",{className:"flex flex-col",children:[m&&(0,a.jsx)("div",{className:"text-xs mt-1 text-[#a3a3a3] text-right",children:m}),(0,a.jsx)("div",{className:"text-xs mb-1 ml-2 ".concat(n?"text-[#7d8590] text-left":"text-[#7d8590] text-right"),children:c}),(0,a.jsxs)("div",{className:"px-4 py-3 rounded-xl relative group ".concat(n?"bg-gradient-to-br from-[#58a6ff] to-[#a855f7] text-white rounded-bl-sm":"bg-[#21262d] border border-[#30363d] text-white rounded-br-sm"),children:[(0,a.jsx)("div",{children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.default,{src:e.content,alt:"sent image",width:320,height:240,className:"max-w-xs rounded-lg mb-1",style:{width:"auto",height:"auto",maxWidth:"20rem",maxHeight:"15rem"},unoptimized:!0,onError:e=>{let t=e.target;t.style.display="none",t.nextSibling instanceof HTMLElement&&(t.nextSibling.style.display="block")}}),(0,a.jsx)("span",{style:{display:"none"},children:e.content})]}):(0,a.jsx)("span",{children:e.content})}),(0,a.jsxs)("div",{className:"text-xs mt-2 ".concat(n?"text-white/70":"text-[#7d8590]"),children:[e.createdAt?new Date(e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",n&&(0,a.jsx)("span",{className:"ml-2",children:"✓✓"})]}),(0,a.jsx)("div",{className:"absolute top-2 ".concat(n?"left-2":"right-2"," opacity-0 group-hover:opacity-100 flex gap-2"),children:(0,a.jsx)("button",{title:"Delete for everyone",className:"text-xs px-2 py-1 bg-black/20 rounded hover:bg-red-600 hover:text-white transition-colors",onClick:()=>B(f.id,e.id),children:"\uD83D\uDDD1️"})})]})]})]},e.id||t)}),(0,a.jsx)("div",{ref:_})]}),(0,a.jsx)("div",{className:"p-5 border-t border-[#30363d]",children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),I()},className:"flex items-center gap-3 bg-[#21262d] border border-[#30363d] rounded-full px-5 py-3",children:[(0,a.jsx)("div",{className:"flex gap-2 text-[#7d8590]",children:(0,a.jsxs)("label",{className:"hover:text-[#58a6ff] transition cursor-pointer",children:["\uD83D\uDCCE",(0,a.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{e.target.files&&e.target.files[0]&&F(e.target.files[0])},disabled:E})]})}),(0,a.jsx)("input",{type:"text",placeholder:"Type your message...",className:"flex-1 bg-transparent text-primary focus:outline-none text-base placeholder-[#7d8590]",value:M,onChange:e=>O(e.target.value),disabled:E}),P&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(o.default,{src:URL.createObjectURL(P),alt:"preview",width:40,height:40,className:"w-10 h-10 object-cover rounded-full mr-2"}),(0,a.jsx)("button",{type:"button",onClick:()=>F(null),className:"text-red-500 text-xs",children:"✕"})]}),(0,a.jsx)("button",{type:"submit",className:"w-8 h-8 rounded-full bg-gradient-to-br from-[#58a6ff] to-[#a855f7] text-white hover:scale-110 transition",disabled:E||!M.trim()&&!P,title:"Send",children:"➤"})]})})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center px-4",children:[(0,a.jsx)("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-[#58a6ff] to-[#a855f7] flex items-center justify-center text-white text-4xl mb-4 shadow-lg",children:"\uD83D\uDCAC"}),(0,a.jsx)("h1",{className:"text-2xl font-semibold text-gradient-purple mb-2",children:"Select a chat"}),(0,a.jsx)("p",{className:"text-secondary text-sm max-w-xs",children:"Choose a conversation from the left panel to start messaging."})]})})})}},49966:(e,t,r)=>{"use strict";let a=r(95155);var l=function(e){return e&&e.__esModule?e:{default:e}};let s=l(r(30862)),n=l(r(48125));t.A=e=>{let{selectedChat:t,handleUpdateOpen:r,handleBack:l,handleGroup:i,handleChatSelect:o,handleClick:d}=e;return(0,a.jsxs)("div",{className:"hidden md:grid md:grid-cols-[30%_70%] overflow-hidden",children:[(0,a.jsx)("div",{className:"overflow-hidden",children:(0,a.jsx)(s.default,{handleGroup:i,onChatSelect:o,handleClick:d})}),(0,a.jsx)("div",{className:"overflow-hidden",children:(0,a.jsx)(n.default,{onBack:l,handleUpdateOpen:r,chat:t})})]})}},59782:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(95155);var l=Object.create?function(e,t,r,a){void 0===a&&(a=r);var l=Object.getOwnPropertyDescriptor(t,r);(!l||("get"in l?!t.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,l)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]},s=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},n=function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var a=e(t),n=0;n<a.length;n++)"default"!==a[n]&&l(r,t,a[n]);return s(r,t),r}}(),i=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(r(12115)),d=r(99082),c=r(59941),u=i(r(84929)),f=i(r(97007)),m=r(92596);t.default=e=>{let{handleClickOutside:t}=e,r=(0,d.useFriendsStore)(e=>e.friends),{createChat:l,chats:s}=(0,c.useChatStore)(),n=r&&r.length>0?r:[],[i,x]=(0,o.useState)(""),[g,h]=(0,o.useState)([]),[p,b]=(0,o.useState)(!1),[v,y]=(0,o.useState)(!1),[j,w]=(0,o.useState)(!1),[N,S]=(0,o.useState)(!1),[C,k]=(0,o.useState)(""),_=e=>{h(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},M=async e=>{if(e.preventDefault(),i.trim()&&g.length>0){let e=i.trim(),r=g.length>=2;if(s.map(e=>e.name).includes(e)){k("A group with this name already exists. Please choose a different name."),S(!0),setTimeout(()=>S(!1),3e3);return}y(!0);try{await new Promise(e=>setTimeout(e,3e3));let a=await l(g,e,r);y(!1),a?(w(!0),setTimeout(()=>{w(!1),t()},2e3)):(k("Error creating group."),S(!0),setTimeout(()=>S(!1),3e3))}catch(e){y(!1),k("Error creating group."),S(!0),setTimeout(()=>S(!1),3e3)}}},O=n.filter(e=>g.includes(e.id)).map(e=>"".concat(e.firstname," ").concat(e.lastname));return(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{backgroundColor:"rgba(13, 17, 23, 0.8)"},onClick:t,children:[v&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-70 z-50 rounded-lg",children:(0,a.jsx)(m.MultiRingSpinner,{})}),j&&(0,a.jsx)(u.default,{message:"Group created!"}),N&&(0,a.jsx)(f.default,{message:C||"Error creating group."}),(0,a.jsx)("div",{className:"relative w-full bg-navbar-bg border-primary border max-w-md rounded-lg shadow-2xl backdrop-blur-sm",onClick:e=>e.stopPropagation(),children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-2 bg-gradient-to-r bg-clip-text text-transparent",style:{backgroundImage:"linear-gradient(90deg, var(--gradient-blue, #58a6ff), var(--gradient-purple, #a855f7))"},children:"Create Group"}),(0,a.jsx)("p",{style:{color:"var(--text-secondary, #7d8590)"},className:"text-sm",children:"Start a new conversation with your team"})]}),(0,a.jsxs)("form",{onSubmit:M,className:"space-y-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"groupName",className:"block text-primary text-sm font-medium mb-2",children:"Group Name *"}),(0,a.jsx)("input",{type:"text",id:"groupName",name:"groupName",required:!0,value:i,onChange:e=>x(e.target.value),placeholder:"Enter group name...",className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-red-500 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-opacity-50 text-sm",style:{backgroundColor:"var(--tertiary-bg, #21262d)",borderColor:"var(--border, #30363d)",color:"var(--text-primary, #e6edf3)"},onFocus:e=>{e.target.style.borderColor="var(--gradient-blue, #58a6ff)",e.target.style.boxShadow="0 0 0 3px rgba(88, 166, 255, 0.1)"},onBlur:e=>{e.target.style.borderColor="var(--border, #30363d)",e.target.style.boxShadow="none"},disabled:v})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"friendsSelect",className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary, #e6edf3)"},children:"Add Friends *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>b(!p),className:"w-full px-4 py-3 rounded-lg border transition-all duration-200 focus:outline-none text-sm text-left flex items-center justify-between",style:{backgroundColor:"var(--tertiary-bg, #21262d)",borderColor:g.length>0?"var(--gradient-blue, #58a6ff)":"var(--border, #30363d)",color:"var(--text-primary, #e6edf3)"},disabled:v,children:[(0,a.jsx)("div",{className:"flex-1",children:0===g.length?(0,a.jsx)("span",{style:{color:"var(--text-secondary, #7d8590)"},children:"Select friends to add..."}):(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[O.slice(0,2).map((e,t)=>(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs",style:{backgroundColor:"var(--overlay-light, rgba(88, 166, 255, 0.1))",color:"var(--gradient-blue, #58a6ff)"},children:e},t)),g.length>2&&(0,a.jsxs)("span",{className:"px-2 py-1 rounded text-xs",style:{backgroundColor:"var(--overlay-purple, rgba(168, 85, 247, 0.1))",color:"var(--gradient-purple, #a855f7)"},children:["+",g.length-2," more"]})]})}),(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",className:"transition-transform duration-200 ".concat(p?"rotate-180":""),style:{color:"var(--text-secondary, #7d8590)"},children:(0,a.jsx)("path",{d:"M4.427 7.427l3.396 3.396a.25.25 0 00.354 0l3.396-3.396A.25.25 0 0011.396 7H4.604a.25.25 0 00-.177.427z"})})]}),p&&(0,a.jsx)("div",{className:"absolute top-full left-0 right-0 mt-1 rounded-lg border shadow-2xl z-10 max-h-60 overflow-y-auto",style:{backgroundColor:"var(--secondary-bg, #161b22)",borderColor:"var(--border, #30363d)"},children:n.map(e=>(0,a.jsxs)("div",{onClick:()=>_(e.id),className:"flex items-center gap-3 px-4 py-3 cursor-pointer transition-all duration-150 first:rounded-t-lg last:rounded-b-lg",style:{backgroundColor:g.includes(e.id)?"var(--overlay-light, rgba(88, 166, 255, 0.1))":"transparent"},onMouseEnter:t=>{g.includes(e.id)||(t.target.style.backgroundColor="var(--active-bg, #1c2128)")},onMouseLeave:t=>{g.includes(e.id)||(t.target.style.backgroundColor="transparent")},children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium",style:{backgroundColor:g.includes(e.id)?"var(--gradient-blue, #58a6ff)":"var(--tertiary-bg, #21262d)",color:g.includes(e.id)?"white":"var(--text-secondary, #7d8590)"},children:e.firstname[0]+e.lastname[0]}),(0,a.jsx)("span",{className:"flex-1 text-sm",style:{color:"var(--text-primary, #e6edf3)"},children:e.firstname}),g.includes(e.id)&&(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",style:{color:"var(--gradient-blue, #58a6ff)"},children:(0,a.jsx)("path",{d:"M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"})})]},e.id))})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"flex-1 py-3 px-4 rounded-lg border font-medium text-sm transition-all duration-200 hover:scale-[1.02]",style:{backgroundColor:"var(--tertiary-bg, #21262d)",borderColor:"var(--border, #30363d)",color:"var(--text-secondary, #7d8590)"},onMouseEnter:e=>{e.target.style.backgroundColor="var(--active-bg, #1c2128)"},onMouseLeave:e=>{e.target.style.backgroundColor="var(--tertiary-bg, #21262d)"},disabled:v,children:"Cancel"}),(0,a.jsxs)("button",{type:"submit",disabled:!i.trim()||0===g.length||v,className:"flex-1 py-3 px-4 rounded-lg font-medium text-sm transition-all duration-200 hover:scale-[1.02] relative overflow-hidden group disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",style:{background:!i.trim()||0===g.length||v?"var(--border, #30363d)":"linear-gradient(90deg, var(--gradient-blue, #58a6ff), var(--gradient-purple, #a855f7))",color:"var(--text-white, white)",border:"none"},children:[(0,a.jsx)("span",{className:"relative z-10",children:"Create Group"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r opacity-0 group-hover:opacity-20 transition-opacity duration-200",style:{backgroundImage:"linear-gradient(90deg, var(--gradient-purple, #a855f7), var(--gradient-orange, #f97316))"}})]})]})]})]})})]})}},59941:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useChatStore=void 0;let a=r(87657),l=function(e){return e&&e.__esModule?e:{default:e}}(r(43653));l.default.defaults.withCredentials=!0,l.default.defaults.baseURL="https://chat-app-tk-blg.fly.dev",t.useChatStore=(0,a.create)((e,t)=>({chats:[],messages:{},loading:!1,error:null,fetchChatsSummary:async()=>{e({loading:!0,error:null});try{let t=(await l.default.get("/message/message-list")).data.chats;e({chats:t,loading:!1})}catch(t){console.error("Error fetching chats:",t),e({error:t instanceof Error?t.message:"Unknown error",loading:!1})}},fetchMessages:async t=>{e({loading:!0,error:null});try{if(!t)return void e({loading:!1});let r=await l.default.get("/message?chatId=".concat(t));e(e=>({messages:{...e.messages,[t]:r.data.messages},loading:!1}))}catch(t){console.error("Error fetching messages:",t),e({error:t instanceof Error?t.message:"Unknown error",loading:!1})}},createChat:async function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e({loading:!0,error:null});try{let n=await l.default.post("/message/create-chat",{participantIds:r,name:a,isGroup:s});await t().fetchChatsSummary();let i=n.data.chat.id,o=t().chats.find(e=>e.id===i)||null;return e({loading:!1}),o}catch(t){return console.error("Error creating chat:",t),e({error:t instanceof Error?t.message:"Unknown error",loading:!1}),null}},sendMessage:async(t,r,a)=>{e({loading:!0,error:null});try{let s=new FormData;s.append("chatId",t.toString()),r&&s.append("content",r),a&&s.append("image",a);let n=await l.default.post("/message/send-message",s,{headers:{"Content-Type":"multipart/form-data"}});e(e=>({messages:{...e.messages,[t]:[...e.messages[t]||[],n.data.message]},loading:!1}))}catch(t){console.error("Error sending message:",t),e({error:t instanceof Error?t.message:"Unknown error",loading:!1})}},updateGroupChat:async function(r,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];e({loading:!0,error:null});try{await l.default.put("/message/update-group/".concat(r),{name:a,addUserIds:s,removeUserIds:n}),await t().fetchChatsSummary(),e({loading:!1})}catch(t){console.error("Error updating group chat:",t),e({error:t instanceof Error?t.message:"Unknown error",loading:!1})}},deleteMessageEveryone:async(t,r)=>{e({loading:!0,error:null});try{await l.default.delete("/message/delete-user/".concat(r)),e(e=>({messages:{...e.messages,[t]:(e.messages[t]||[]).filter(e=>e.id!==r)},loading:!1}))}catch(t){console.error("Error deleting message for everyone:",t),e({error:t instanceof Error?t.message:"Unknown error",loading:!1})}},deleteChatEveryone:async t=>{e({loading:!0,error:null});try{await l.default.delete("/message/delete-everyone/".concat(t)),e(e=>({chats:e.chats.filter(e=>e.id!==t),messages:Object.fromEntries(Object.entries(e.messages).filter(e=>{let[r]=e;return Number(r)!==t})),loading:!1}))}catch(t){console.error("Error deleting chat for everyone:",t),e({error:t instanceof Error?t.message:"Unknown error",loading:!1})}},clearError:()=>e({error:null})}))},60040:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(95155);var l=Object.create?function(e,t,r,a){void 0===a&&(a=r);var l=Object.getOwnPropertyDescriptor(t,r);(!l||("get"in l?!t.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,l)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]},s=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},n=function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var a=e(t),n=0;n<a.length;n++)"default"!==a[n]&&l(r,t,a[n]);return s(r,t),r}}(),i=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(r(12115)),d=i(r(22481)),c=i(r(24679)),u=i(r(42985)),f=r(89869),m=r(99082),x=r(59941),g=r(66607),h=r(20604);t.default=e=>{let{onChatSelect:t}=e,{allUsers:r,friends:l,loading:s,error:n,fetchFriends:i,fetchOnlineFriends:p,addFriend:b,removeFriend:v,searchFriends:y,clearSearch:j}=(0,m.useFriendsStore)(),{fetchChatsSummary:w,createChat:N}=(0,x.useChatStore)(),[S,C]=(0,o.useState)({}),k=x.useChatStore.getState().chats.map(e=>({...e,participants:e.participants.map(e=>{var t;return{id:e.id,name:null!=(t=e.name)?t:""}}),lastMessage:null===e.lastMessage?void 0:e.lastMessage,lastMessageAt:null===e.lastMessageAt?void 0:e.lastMessageAt})),_=(0,g.useAuthStore)(e=>e.user),[M,O]=(0,o.useState)("all"),[P,F]=(0,o.useState)(""),{socket:E}=(0,h.useSocketContext)(),A=(0,o.useCallback)(()=>{let e=m.useFriendsStore.getState().onlineFriends,t=[];t=P.trim()?m.useFriendsStore.getState().searchResults:(0,f.getFilteredUsers)(M,"");let r={};t.forEach(t=>{r[t.id]=e.includes(t.id)?"online":"offline"}),C(r)},[M,P]);(0,o.useEffect)(()=>{if(!(null==_?void 0:_.id)||!E)return;let e=()=>{p(),A()};return E.on("user_online",e),E.on("user_offline",e),p(),()=>{E.off("user_online",e),E.off("user_offline",e)}},[null==_?void 0:_.id,p,A,E]),(0,o.useEffect)(()=>{A()},[A]),(0,o.useEffect)(()=>{P.trim()?y(P):j()},[P,y,j]);let L=P.trim()?m.useFriendsStore.getState().searchResults:r,D=(0,f.getFilteredUsers)(M,P).filter(e=>L.some(t=>t.id===e.id)),U=async e=>{await b(e),await i(),await p()},z=async e=>{await v(e),await i(),await p(),await w()},R=async e=>{try{if(!(null==_?void 0:_.id))throw Error("User not authenticated");let l=k.find(t=>{if(!Array.isArray(t.participants)||2!==t.participants.length)return!1;let r=t.participants.map(e=>e.id).sort(),a=[_.id,e].sort();return!t.isGroup&&r[0]===a[0]&&r[1]===a[1]});if(l)return void t(l.id,l);let s=await N([e],void 0,!1);if(s){var r,a;let e={...s,participants:(s.participants||[]).map(e=>{var t,r,a;return{id:e.id,name:null!=(a=null!=(r=null!=(t=e.name)?t:e.firstname)?r:e.lastname)?a:""}}),lastMessage:null!=(r=s.lastMessage)?r:void 0,lastMessageAt:null!=(a=s.lastMessageAt)?a:void 0};t(Number(e.id),e);return}await w(),setTimeout(()=>{let r=(x.useChatStore.getState().chats||[]).find(t=>Array.isArray(t.participants)&&t.participants.some(t=>(null==t?void 0:t.id)===e));if(r){var a,l;let e={...r,participants:r.participants.map(e=>{var t,r,a;return{id:e.id,name:null!=(a=null!=(r=null!=(t=e.name)?t:e.firstname)?r:e.lastname)?a:""}}),lastMessage:null!=(a=r.lastMessage)?a:void 0,lastMessageAt:null!=(l=r.lastMessageAt)?l:void 0};t(e.id,e)}},100)}catch(e){console.error("Error in handleMessage:",e)}};return(0,a.jsxs)("div",{className:"flex flex-col h-full min-h-0 max-h-screen",children:[(0,a.jsx)(u.default,{value:P,onChange:F}),(0,a.jsx)(c.default,{activeTab:M,onTabChange:O}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto scrollbar-auto-hide p-4 space-y-3",children:[s&&(0,a.jsx)("div",{className:"text-center text-gray-400",children:"Loading..."}),n&&(0,a.jsx)("div",{className:"text-center text-red-500",children:n}),!s&&!n&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-primary",children:"all"===M?"All Users (A–Z)":"online"===M?"Online Friends":"My Friends"}),(0,a.jsxs)("span",{className:"text-sm text-gray-400",children:[D.length," users"]})]}),D.length?D.map(e=>{let t=l.some(t=>t.id===e.id),r=S[e.id]||"offline";return(0,a.jsx)(d.default,{isFriend:t,user:e,status:r,onMessage:t?()=>R(e.id):void 0,onAdd:t?void 0:()=>U(e.id),onRemove:t?()=>z(e.id):void 0},e.id)}):(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"text-gray-400 mb-2",children:"No results found"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Try adjusting your search or browse different categories"})]})]})]})]})}},66607:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useAuthStore=void 0;let a=r(87657),l=function(e){return e&&e.__esModule?e:{default:e}}(r(43653)),s=r(82127);l.default.defaults.withCredentials=!0,l.default.defaults.baseURL="https://chat-app-tk-blg.fly.dev",t.useAuthStore=(0,a.create)()((0,s.devtools)(e=>({user:null,isAuthenticated:!1,isLoading:!1,error:null,getSession:async()=>{var t,r;try{let r=(await l.default.get("/login/user",{withCredentials:!0})).data.user;e({user:r,isAuthenticated:null==(t=null==r?void 0:r.verified)||t,isLoading:!1,error:null})}catch(t){try{await l.default.post("/login/refresh",{},{withCredentials:!0});let t=(await l.default.get("/login/user",{withCredentials:!0})).data.user;e({user:t,isAuthenticated:null==(r=null==t?void 0:t.verified)||r,isLoading:!1,error:null})}catch(t){e({user:null,isAuthenticated:!1,error:"Session expired"})}}},login:async t=>{var r,a,s,n;let{email:i,password:o}=t;e({isLoading:!0,error:null});try{let t=await l.default.post("/login",{email:i,password:o});e({user:t.data.user,isAuthenticated:null!=(a=null==(r=t.data.user)?void 0:r.verified)&&a})}catch(t){e({error:(null==(n=t.response)||null==(s=n.data)?void 0:s.message)||t.message})}finally{e({isLoading:!1})}},googleLogin:()=>{window.location.href="login/google"},logout:async()=>{e({isLoading:!0,error:null});try{await l.default.post("/login/logout"),e({user:null,isAuthenticated:!1,error:null})}catch(a){var t,r;e({error:(null==(r=a.response)||null==(t=r.data)?void 0:t.message)||a.message})}finally{e({isLoading:!1})}},reset:()=>e({user:null,isLoading:!1,error:null})})))},66663:(e,t,r)=>{Promise.resolve().then(r.bind(r,44879))},71183:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(95155);Object.defineProperty(t,"__esModule",{value:!0});let l=r(12115),s=r(92599),n=r(47937),i=function(e){return e&&e.__esModule?e:{default:e}}(r(66766));t.default=()=>{var e,t;let{uploadStory:r,setUploadModalOpen:o,myStoryGroup:d,fetchMyStories:c,getStoryViewers:u,loading:f,error:m,deleteStory:x}=(0,s.useStoryStore)(),[g,h]=(0,l.useState)("view"),[p,b]=(0,l.useState)("text"),[v,y]=(0,l.useState)(""),[j,w]=(0,l.useState)(null),[N,S]=(0,l.useState)(null),[C,k]=(0,l.useState)(!1),_=(0,l.useRef)(null),[M,O]=(0,l.useState)({}),[P,F]=(0,l.useState)(!1),[E,A]=(0,l.useState)(null);(0,l.useEffect)(()=>{c()},[c]),(0,l.useEffect)(()=>{(async()=>{if(d&&d.stories){let e={};await Promise.all(d.stories.map(async t=>{let r=await u(t.id);e[t.id]=Array.isArray(r)?r:[]})),O(e)}})()},[d,u]);let L=e=>{w(e),S(URL.createObjectURL(e))},D=async()=>{if("text"===p&&!v.trim()||"image"===p&&!j)return;k(!0);let e=new FormData;e.append("type",p),"text"===p&&e.append("content",v),"image"===p&&j&&e.append("image",j);try{await r(e),o(!1),y(""),w(null),S(null)}catch(e){console.error("Upload failed:",e)}finally{k(!1)}},U=async e=>{await x(e),O(t=>{let r={...t};return delete r[e],r}),console.log("Delete story:",e)},z=e=>{let t=new Date(e),r=Math.floor((new Date().getTime()-t.getTime())/36e5);return r<1?"Just now":r<24?"".concat(r,"h ago"):"".concat(Math.floor(r/24),"d ago")},R=(null==d?void 0:d.stories)||[],T=async e=>{let t=await u(e);O(r=>({...r,[e]:Array.isArray(t)?t:[]})),A(e),F(!0)};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-gray-900 rounded-2xl w-full max-w-md h-[600px] text-white relative overflow-hidden border border-gray-700",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-700",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Your Stories"}),(0,a.jsx)("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-white p-2 hover:bg-gray-800 rounded-full transition-all",children:(0,a.jsx)(n.X,{size:20})})]}),(0,a.jsxs)("div",{className:"flex border-b border-gray-700",children:[(0,a.jsxs)("button",{onClick:()=>h("view"),className:"flex-1 px-6 py-3 text-sm font-medium transition-all ".concat("view"===g?"text-blue-400 border-b-2 border-blue-400 bg-blue-400/10":"text-gray-400 hover:text-white hover:bg-gray-800"),children:[(0,a.jsx)(n.Eye,{size:16,className:"inline mr-2"}),"View Stories"]}),(0,a.jsxs)("button",{onClick:()=>h("upload"),className:"flex-1 px-6 py-3 text-sm font-medium transition-all ".concat("upload"===g?"text-blue-400 border-b-2 border-blue-400 bg-blue-400/10":"text-gray-400 hover:text-white hover:bg-gray-800"),children:[(0,a.jsx)(n.Plus,{size:16,className:"inline mr-2"}),"Add Story"]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:"view"===g?(0,a.jsx)("div",{className:"h-full overflow-y-auto p-6",children:f?(0,a.jsx)("p",{className:"text-center text-gray-400",children:"Loading..."}):m?(0,a.jsx)("p",{className:"text-center text-red-500",children:m}):0===R.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[(0,a.jsx)("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4",children:(0,a.jsx)(n.Camera,{size:32,className:"text-gray-400"})}),(0,a.jsx)("p",{className:"text-gray-400 mb-2",children:"No stories yet"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Share your first story with friends"}),(0,a.jsx)("button",{onClick:()=>h("upload"),className:"mt-4 bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-full transition-all",children:"Create Story"})]}):(0,a.jsx)("div",{className:"space-y-4 overflow-y-auto max-h-[400px] scrollbar-thin",children:R.map(e=>{var t,r;return(0,a.jsxs)("div",{className:"bg-gray-800 rounded-xl p-4 border border-gray-700",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-sm",children:"\uD83D\uDC64"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-sm",children:"Your Story"}),(0,a.jsx)("p",{className:"text-gray-400 text-xs",children:z(e.createdAt)})]})]}),(0,a.jsx)("button",{onClick:()=>U(e.id),className:"text-gray-400 hover:text-red-400 p-1 hover:bg-gray-700 rounded transition-all",children:(0,a.jsx)(n.Trash2,{size:16})})]}),"text"===e.type?(0,a.jsx)("div",{className:"bg-gradient-to-br from-blue-600 to-purple-600 rounded-lg p-4 mb-3",children:(0,a.jsx)("p",{className:"text-white text-center font-medium",children:e.content})}):(0,a.jsx)("div",{className:"relative aspect-[3/4] rounded-lg overflow-hidden mb-3",children:(0,a.jsx)(i.default,{src:e.content,fill:!0,alt:"Story",className:"object-cover"})}),(0,a.jsx)("div",{className:"flex items-center gap-4 text-sm text-gray-400",children:(0,a.jsxs)("button",{onClick:()=>T(e.id),className:"flex items-center gap-1",children:[(0,a.jsx)(n.Eye,{size:14}),(0,a.jsxs)("span",{children:[null!=(r=null==(t=M[e.id])?void 0:t.length)?r:0," views"]})]})})]},e.id)})})}):(0,a.jsxs)("div",{className:"h-full flex flex-col p-6",children:[(0,a.jsxs)("div",{className:"flex gap-2 mb-6",children:[(0,a.jsxs)("button",{onClick:()=>{b("text"),w(null),S(null)},className:"flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl transition-all ".concat("text"===p?"bg-blue-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700 hover:text-white"),children:[(0,a.jsx)(n.Type,{size:18}),(0,a.jsx)("span",{className:"font-medium",children:"Text"})]}),(0,a.jsxs)("button",{onClick:()=>{b("image"),y("")},className:"flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl transition-all ".concat("image"===p?"bg-blue-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700 hover:text-white"),children:[(0,a.jsx)(n.ImageIcon,{size:18}),(0,a.jsx)("span",{className:"font-medium",children:"Image"})]})]}),(0,a.jsx)("div",{className:"flex-1 mb-6",children:"text"===p?(0,a.jsxs)("div",{className:"h-full",children:[(0,a.jsx)("textarea",{value:v,onChange:e=>y(e.target.value),className:"w-full h-full bg-gray-800 border border-gray-700 rounded-xl p-4 text-white placeholder-gray-400 resize-none focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500",placeholder:"Share what's on your mind...",maxLength:280}),(0,a.jsx)("div",{className:"flex justify-between items-center mt-2",children:(0,a.jsxs)("span",{className:"text-xs text-gray-400",children:[v.length,"/280 characters"]})})]}):(0,a.jsxs)("div",{className:"h-full",children:[(0,a.jsx)("input",{ref:_,type:"file",accept:"image/*",onChange:e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];r&&L(r)},className:"hidden"}),N?(0,a.jsxs)("div",{className:"relative h-full rounded-xl overflow-hidden",children:[(0,a.jsx)(i.default,{src:N,fill:!0,alt:"Preview",className:"object-cover"}),(0,a.jsx)("button",{onClick:()=>{w(null),S(null)},className:"absolute top-3 right-3 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-all",children:(0,a.jsx)(n.X,{size:16})})]}):(0,a.jsxs)("div",{onClick:()=>{var e;return null==(e=_.current)?void 0:e.click()},className:"h-full border-2 border-dashed border-gray-600 rounded-xl flex flex-col items-center justify-center cursor-pointer hover:border-gray-500 hover:bg-gray-800/50 transition-all",children:[(0,a.jsx)(n.Camera,{size:48,className:"text-gray-400 mb-4"}),(0,a.jsx)("p",{className:"text-gray-400 font-medium mb-2",children:"Choose a photo"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 text-center",children:"Tap to select an image from your device"})]})]})}),(0,a.jsx)("button",{onClick:D,disabled:C||"text"===p&&!v.trim()||"image"===p&&!j,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-4 rounded-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:C?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Uploading..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.Upload,{size:20}),"Share Story"]})})]})}),P&&null!==E&&(0,a.jsx)("div",{className:"absolute inset-0 bg-black/90 z-20 flex items-end",children:(0,a.jsxs)("div",{className:"w-full max-w-md mx-auto bg-gray-900 rounded-t-3xl p-6 max-h-96 overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-white font-semibold",children:["Viewed by ",null!=(t=null==(e=M[E])?void 0:e.length)?t:0]}),(0,a.jsx)("button",{onClick:()=>F(!1),className:"text-white/70 hover:text-white p-1",children:(0,a.jsx)(n.X,{size:20})})]}),(0,a.jsxs)("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:[(M[E]||[]).map(e=>{var t,r,l,s;return(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center text-lg",children:[null==(r=e.firstname)||null==(t=r[0])?void 0:t.toUpperCase(),null==(s=e.lastname)||null==(l=s[0])?void 0:l.toUpperCase()]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-white font-medium text-sm",children:[e.firstname," ",e.lastname]}),(0,a.jsx)("p",{className:"text-gray-400 text-xs",children:new Date(e.viewedAt).toLocaleString([],{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})},e.id)}),0===(M[E]||[]).length&&(0,a.jsx)("div",{className:"text-center text-gray-400",children:"No viewers yet"})]})]})})]})})}},84929:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(95155);Object.defineProperty(t,"__esModule",{value:!0});let l=r(35695),s=function(e){return e&&e.__esModule?e:{default:e}}(r(12115));t.default=e=>{let{message:t,showContinueButton:r,handleTimeout:n,url:i,tempState:o}=e,d=(0,l.useRouter)(),[c,u]=s.default.useState(!0);return c?(0,a.jsx)("div",{id:"success-popup",className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,a.jsxs)("div",{className:"bg-gray-800 text-primary rounded-2xl p-8 max-w-md w-full relative shadow-lg",children:[(0,a.jsx)("button",{onClick:()=>{u(!1),n&&n()},className:"absolute top-3 right-4 text-2xl text-white hover:text-red-400",children:"\xd7"}),(0,a.jsxs)("div",{className:"flex flex-col items-center success-popup",children:[(0,a.jsx)("div",{className:"w-16 h-16 flex items-center justify-center rounded-full bg-gradient-to-br from-green-500 to-green-600 text-white text-3xl mb-4",children:"✓"}),(0,a.jsx)("h2",{className:"text-2xl font-bold mb-2 text-white",children:"Success!"}),(0,a.jsx)("p",{className:"text-sm text-gray-300 text-center",children:t})]}),(0,a.jsxs)("svg",{className:"w-16 h-16 mt-6 mx-auto text-green-500",viewBox:"0 0 52 52",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("circle",{cx:"26",cy:"26",r:"25",stroke:"currentColor",strokeWidth:"2"}),(0,a.jsx)("path",{d:"M14.1 27.2l7.1 7.2 16.7-16.8",stroke:"currentColor",strokeWidth:"2",fill:"none"})]}),r&&(0,a.jsx)("div",{className:"mt-6 text-center",children:(0,a.jsx)("button",{className:"bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 rounded-lg text-white font-semibold hover:shadow-lg transition",onClick:()=>{n&&n();let e=i?o?"".concat(i,"?tempState=").concat(encodeURIComponent(o)):i:"/";d.push(e)},children:"Continue"})})]})}):null}},87822:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(95155);Object.defineProperty(t,"__esModule",{value:!0});let l=r(12115),s=r(41795),n=r(35695),i=r(99082),o=r(59941),d=r(47937),c=function(e){return e&&e.__esModule?e:{default:e}}(r(66766));t.default=()=>{let{getProfile:e,user:t,updateProfile:r,uploadProfilePicture:u,isLoading:f}=(0,s.useProfileStore)(),[m,x]=(0,l.useState)(""),[g,h]=(0,l.useState)(""),[p,b]=(0,l.useState)(""),[v,y]=(0,l.useState)(null),{friends:j}=(0,i.useFriendsStore)(),w=(0,n.useRouter)(),{chats:N}=(0,o.useChatStore)();(0,l.useEffect)(()=>{(async()=>{await e()})()},[e]),(0,l.useEffect)(()=>{t&&(x(t.firstname),h(t.lastname),b(t.email),y(t.profilePicture||""))},[t]);let S=N.filter(e=>e.isGroup),C=async e=>{e.preventDefault();try{console.log("Updating profile with:",{firstName:m,lastName:g,email:p}),await r({firstname:m,lastname:g,email:p}),console.log("Profile updated successfully")}catch(e){console.error("Failed to update profile:",e),alert("Error updating profile. Please try again.")}},k=(0,l.useRef)(null),_="".concat((null==m?void 0:m[0])||"").concat((null==g?void 0:g[0])||"");return(0,a.jsxs)("div",{id:"profile",children:[(0,a.jsxs)("div",{className:"text-center  mb-6 pt-4",children:[(0,a.jsx)("h1",{className:"bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent text-3xl font-bold mb-2",children:"Profile"}),(0,a.jsx)("p",{className:"text-secondary",children:"Manage your personal information"})]}),(0,a.jsxs)("div",{className:"bg-[#161b22]/80 border border-primary rounded-2xl p-6 mb-4 relative overflow-hidden text-center backdrop-blur-lg",children:[(0,a.jsx)("div",{className:"absolute top-0 left-0 right-0 h-20 bg-gradient-purple opacity-10"}),(0,a.jsxs)("div",{className:"w-20 h-20 rounded-full border-4 border-blue-400 mx-auto bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center text-3xl text-white cursor-pointer overflow-hidden relative z-10",onClick:()=>{var e;null==(e=k.current)||e.click()},children:[(0,a.jsx)("input",{type:"file",accept:"image/*",ref:k,onChange:e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];r&&u(r)},className:"hidden"}),v?(0,a.jsx)(c.default,{width:80,height:80,src:v,alt:"Profile",className:"w-full h-full object-cover"}):_,(0,a.jsx)("div",{className:"absolute bottom-0 z-[1000] right-1 bg-black/60 rounded-full p-1 flex items-center justify-center ",children:(0,a.jsx)(d.Camera,{className:"w-5 h-5 text-white"})})]}),(0,a.jsxs)("div",{className:"text-xl font-bold mt-2",children:[m," ",g]}),(0,a.jsxs)("div",{className:"flex justify-around pt-4 border-t border-primary",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-xl font-bold text-blue-400",children:j.length}),(0,a.jsx)("div",{className:"text-secondary text-sm",children:"Friends"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-xl font-bold text-blue-400",children:S.length}),(0,a.jsx)("div",{className:"text-secondary text-sm",children:"Groups"})]})]})]}),(0,a.jsxs)("form",{onSubmit:C,className:"bg-[#161b22]/80 border border-primary rounded-2xl p-6 mb-4 backdrop-blur-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Edit Profile"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block mb-2 font-medium",children:"First Name"}),(0,a.jsx)("input",{type:"text",className:"w-full p-3 bg-primary border border-primary rounded-lg text-base focus:outline-none focus:border-blue-400 focus:ring-2 focus:ring-blue-400/10",value:m,onChange:e=>x(e.target.value),placeholder:"Enter your first name"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block mb-2 font-medium",children:"Last Name"}),(0,a.jsx)("input",{type:"text",className:"w-full p-3 bg-primary border border-primary rounded-lg text-base focus:outline-none focus:border-blue-400 focus:ring-2 focus:ring-blue-400/10",value:g,onChange:e=>h(e.target.value),placeholder:"Enter your last name"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block mb-2 font-medium",children:"Email"}),(0,a.jsx)("input",{type:"email",className:"w-full p-3 bg-primary border border-primary rounded-lg text-base focus:outline-none focus:border-blue-400 focus:ring-2 focus:ring-blue-400/10",value:p,onChange:e=>b(e.target.value),placeholder:"Enter your email"})]}),(0,a.jsxs)("button",{type:"button",onClick:()=>w.push("/change-password"),className:"w-full flex items-center justify-center gap-2 bg-gradient-purple text-primary py-2 px-6 rounded-lg font-semibold hover:translate-y-[-2px] hover:shadow-lg transition disabled:opacity-50",children:[(0,a.jsx)("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:(0,a.jsx)("path",{d:"M3 8a5 5 0 1 1 9.584 1H16v2h-2v2h-2v-2H9v-2.416A5 5 0 0 1 3 8zm5-3a3 3 0 1 0 0 6 3 3 0 0 0 0-6z"})}),"Change password"]}),(0,a.jsxs)("button",{type:"submit",disabled:f,className:"w-full mt-2 flex items-center justify-center gap-2 bg-gradient-purple text-primary py-2 px-6 rounded-lg font-semibold hover:translate-y-[-2px] hover:shadow-lg transition disabled:opacity-50",children:[(0,a.jsx)("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:(0,a.jsx)("path",{d:"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708L9.708 9H2.5A1.5 1.5 0 0 0 1 10.5v.5a.5.5 0 0 0 .5.5h.5a.5.5 0 0 1 .5.5v.5a.5.5 0 0 0 .5.5h.5a.5.5 0 0 1 .5.5v.5a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5V14h1.5a.5.5 0 0 0 .5-.5v-2.293L15.854 3.854a.5.5 0 0 0 0-.708l-3-3z"})}),f?"Saving...":"Save Changes"]})]})]})}},89578:(e,t,r)=>{"use strict";let a=r(95155);var l=function(e){return e&&e.__esModule?e:{default:e}};let s=l(r(30862)),n=l(r(48125));t.A=e=>{let{selectedChat:t,handleUpdateOpen:r,handleBack:l,handleGroup:i,handleChatSelect:o,handleClick:d}=e;return(0,a.jsx)("div",{className:"md:hidden overflow-hidden ",children:t?(0,a.jsx)(n.default,{chat:t,handleUpdateOpen:r,onBack:l}):(0,a.jsx)(s.default,{handleGroup:i,onChatSelect:o,handleClick:d})})}},89869:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFilteredUsers=t.getStatusColor=void 0;let a=r(99082);t.getStatusColor=e=>{switch(e){case"online":return"bg-green-500";case"away":return"bg-yellow-500";default:return"bg-gray-500"}},t.getFilteredUsers=(e,t)=>{let{allUsers:r,friends:l,onlineFriends:s}=a.useFriendsStore.getState(),n=[];switch(e){case"online":n=r.filter(e=>s.includes(e.id));break;case"friends":n=l;break;default:n=r}return n.filter(e=>e.firstname.toLowerCase().includes(t.toLowerCase())||e.lastname.toLowerCase().includes(t.toLowerCase())||e.email.toLowerCase().includes(t.toLowerCase()))}},91625:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(95155);var l=Object.create?function(e,t,r,a){void 0===a&&(a=r);var l=Object.getOwnPropertyDescriptor(t,r);(!l||("get"in l?!t.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,l)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]},s=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},n=function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var a=e(t),n=0;n<a.length;n++)"default"!==a[n]&&l(r,t,a[n]);return s(r,t),r}}(),i=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(r(12115)),d=r(99082),c=r(59941),u=i(r(84929)),f=i(r(97007)),m=r(92596);t.default=e=>{let{handleClickOutside:t,onGroupUpdated:r,group:l}=e,s=(0,d.useFriendsStore)(e=>e.friends),{chats:n,updateGroupChat:i}=(0,c.useChatStore)(),x=null!=s?s:[],[g,h]=(0,o.useState)(l.name),[p,b]=(0,o.useState)(l.participants),[v,y]=(0,o.useState)(!1),[j,w]=(0,o.useState)(!1),[N,S]=(0,o.useState)(!1),[C,k]=(0,o.useState)(!1),[_,M]=(0,o.useState)(""),O=e=>{b(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},P=async e=>{if(console.log("Submitting group update...",l.id),e.preventDefault(),!g.trim()||p.length<2)return;console.log("Submitting group update:",g,p);let a=g.trim();if(n.some(e=>e.name===a&&e.id!==l.id)){M("A group with this name already exists."),k(!0),setTimeout(()=>k(!1),3e3);return}w(!0);try{await new Promise(e=>setTimeout(e,2e3));let e=l.participants,s=p.filter(t=>!e.includes(t)),n=e.filter(e=>!p.includes(e));await i(l.id,a,s,n),r({id:l.id,name:a,participants:p}),w(!1),S(!0),setTimeout(()=>{S(!1),t()},2e3)}catch(e){w(!1),M("Failed to update group."),k(!0),setTimeout(()=>k(!1),3e3)}},F=x.filter(e=>p.includes(e.id)).map(e=>"".concat(e.firstname," ").concat(e.lastname));return(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{backgroundColor:"rgba(13, 17, 23, 0.8)"},onClick:t,children:[N&&(0,a.jsx)(u.default,{message:"Group updated!"}),C&&(0,a.jsx)(f.default,{message:_}),j&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-70 z-50 rounded-lg",children:(0,a.jsx)(m.MultiRingSpinner,{})}),(0,a.jsx)("div",{className:"relative w-full bg-navbar-bg border-primary border max-w-md rounded-lg shadow-2xl backdrop-blur-sm",onClick:e=>e.stopPropagation(),children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-2 bg-gradient-to-r bg-clip-text text-transparent",style:{backgroundImage:"linear-gradient(90deg, var(--gradient-blue, #58a6ff), var(--gradient-purple, #a855f7))"},children:"Update Group"}),(0,a.jsx)("p",{style:{color:"var(--text-secondary, #7d8590)"},className:"text-sm",children:"Modify group name or members"})]}),(0,a.jsxs)("form",{onSubmit:P,className:"space-y-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"groupName",className:"block text-primary text-sm font-medium mb-2",children:"Group Name *"}),(0,a.jsx)("input",{type:"text",id:"groupName",required:!0,value:g,onChange:e=>h(e.target.value),className:"w-full px-4 py-3 rounded-lg border text-sm",style:{backgroundColor:"var(--tertiary-bg, #21262d)",borderColor:"var(--border, #30363d)",color:"var(--text-primary, #e6edf3)"},onFocus:e=>{e.target.style.borderColor="var(--gradient-blue, #58a6ff)",e.target.style.boxShadow="0 0 0 3px rgba(88, 166, 255, 0.1)"},onBlur:e=>{e.target.style.borderColor="var(--border, #30363d)",e.target.style.boxShadow="none"},disabled:j})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"friendsSelect",className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Group Members *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>y(!v),className:"w-full px-4 py-3 rounded-lg border text-sm text-left flex items-center justify-between",style:{backgroundColor:"var(--tertiary-bg)",borderColor:p.length>0?"var(--gradient-blue)":"var(--border)",color:"var(--text-primary)"},disabled:j,children:[(0,a.jsx)("div",{className:"flex-1",children:0===p.length?(0,a.jsx)("span",{style:{color:"var(--text-secondary)"},children:"Select friends to add..."}):(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[F.slice(0,2).map((e,t)=>(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs",style:{backgroundColor:"rgba(88, 166, 255, 0.1)",color:"var(--gradient-blue)"},children:e},t)),p.length>2&&(0,a.jsxs)("span",{className:"px-2 py-1 rounded text-xs",style:{backgroundColor:"rgba(168, 85, 247, 0.1)",color:"var(--gradient-purple)"},children:["+",p.length-2," more"]})]})}),(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",className:"transition-transform duration-200 ".concat(v?"rotate-180":""),style:{color:"var(--text-secondary)"},children:(0,a.jsx)("path",{d:"M4.427 7.427l3.396 3.396a.25.25 0 00.354 0l3.396-3.396A.25.25 0 0011.396 7H4.604a.25.25 0 00-.177.427z"})})]}),v&&(0,a.jsx)("div",{className:"absolute top-full left-0 right-0 mt-1 rounded-lg border shadow-2xl z-[1000] max-h-60 overflow-y-auto",style:{backgroundColor:"var(--secondary-bg, #161b22)",borderColor:"var(--border, #30363d)"},children:x.map(e=>(0,a.jsxs)("div",{onClick:()=>O(e.id),className:"flex items-center gap-3 px-4 py-3 cursor-pointer transition-all",style:{backgroundColor:p.includes(e.id)?"rgba(88, 166, 255, 0.1)":"transparent"},children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium",style:{backgroundColor:p.includes(e.id)?"var(--gradient-blue)":"var(--tertiary-bg)",color:p.includes(e.id)?"white":"var(--text-secondary)"},children:e.firstname[0]+e.lastname[0]}),(0,a.jsx)("span",{className:"flex-1 text-sm",style:{color:"var(--text-primary)"},children:e.firstname}),p.includes(e.id)&&(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",style:{color:"var(--gradient-blue)"},children:(0,a.jsx)("path",{d:"M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"})})]},e.id))})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"flex-1 py-3 px-4 rounded-lg border font-medium text-sm",style:{backgroundColor:"var(--tertiary-bg)",borderColor:"var(--border)",color:"var(--text-secondary)"},children:"Cancel"}),(0,a.jsxs)("button",{type:"submit",disabled:!g.trim()||p.length<2||j,className:"flex-1 py-3 px-4 rounded-lg font-medium text-sm relative overflow-hidden group",style:{background:!g.trim()||p.length<2||j?"var(--border)":"linear-gradient(90deg, var(--gradient-blue), var(--gradient-purple))",color:"white",border:"none",opacity:j?.5:1,cursor:j?"not-allowed":"pointer"},children:[(0,a.jsx)("span",{className:"relative z-10",children:"Update Group"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r opacity-0 group-hover:opacity-20 transition-opacity duration-200",style:{backgroundImage:"linear-gradient(90deg, var(--gradient-purple), var(--gradient-orange))"}})]})]})]})]})})]})}},92596:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(95155);Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingSpinner=t.SimpleSpinner=t.ChatMessageLoading=t.TypingIndicator=t.GradientRingSpinner=t.PulsingDotsSpinner=t.MultiRingSpinner=void 0,t.MultiRingSpinner=e=>{let{size:t="md",className:r=""}=e;return(0,a.jsxs)("div",{className:"relative ".concat({sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16"}[t]," ").concat(r),children:[(0,a.jsx)("div",{className:"absolute inset-0 border-2 border-transparent border-t-[#58a6ff] rounded-full animate-spin"}),(0,a.jsx)("div",{className:"absolute top-1 left-1 right-1 bottom-1 border-2 border-transparent border-t-[#a855f7] rounded-full animate-spin-reverse",style:{animationDuration:"1.5s"}}),(0,a.jsx)("div",{className:"absolute top-2 left-2 right-2 bottom-2 border-2 border-transparent border-t-[#f97316] rounded-full animate-spin",style:{animationDuration:"2s"}})]})},t.PulsingDotsSpinner=e=>{let{size:t="md",className:r=""}=e,l={sm:"w-1.5 h-1.5",md:"w-2 h-2",lg:"w-3 h-3"};return(0,a.jsxs)("div",{className:"flex ".concat({sm:"gap-1",md:"gap-2",lg:"gap-3"}[t]," ").concat(r),children:[(0,a.jsx)("div",{className:"".concat(l[t]," rounded-full bg-gradient-to-r from-[#58a6ff] to-[#a855f7] animate-pulse-scale"),style:{animationDelay:"-0.32s"}}),(0,a.jsx)("div",{className:"".concat(l[t]," rounded-full bg-gradient-to-r from-[#58a6ff] to-[#a855f7] animate-pulse-scale"),style:{animationDelay:"-0.16s"}}),(0,a.jsx)("div",{className:"".concat(l[t]," rounded-full bg-gradient-to-r from-[#58a6ff] to-[#a855f7] animate-pulse-scale")})]})},t.GradientRingSpinner=e=>{let{size:t="md",className:r=""}=e;return(0,a.jsx)("div",{className:"relative ".concat({sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16"}[t]," ").concat(r),children:(0,a.jsx)("div",{className:"w-full h-full rounded-full animate-spin",style:{background:"conic-gradient(from 0deg, transparent, #58a6ff, #a855f7, #f97316, transparent)",animationDuration:"1.2s"},children:(0,a.jsx)("div",{className:"absolute inset-0.5 bg-[#0d1117] rounded-full"})})})},t.TypingIndicator=e=>{let{className:t=""}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-1 px-4 py-3 bg-[rgba(22,27,34,0.8)] border border-[#30363d] rounded-2xl backdrop-blur-sm ".concat(t),children:[(0,a.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-[#7d8590] animate-typing",style:{animationDelay:"0s"}}),(0,a.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-[#7d8590] animate-typing",style:{animationDelay:"0.2s"}}),(0,a.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-[#7d8590] animate-typing",style:{animationDelay:"0.4s"}})]})},t.ChatMessageLoading=e=>{let{message:t="AI is thinking...",className:r=""}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-[rgba(22,27,34,0.8)] border border-[#30363d] rounded-xl backdrop-blur-sm max-w-sm ".concat(r),children:[(0,a.jsx)("div",{className:"w-5 h-5 border-2 border-[#30363d] border-t-[#58a6ff] rounded-full animate-spin flex-shrink-0"}),(0,a.jsx)("span",{className:"text-[#7d8590] text-sm",children:t})]})},t.SimpleSpinner=e=>{let{size:t="md",className:r=""}=e;return(0,a.jsx)("div",{className:"".concat({sm:"w-4 h-4 border-2",md:"w-6 h-6 border-2",lg:"w-8 h-8 border-3"}[t]," border-[#30363d] border-t-[#58a6ff] rounded-full animate-spin ").concat(r)})},t.LoadingSpinner=e=>{let{variant:r="simple",size:l="md",message:s,className:n=""}=e;switch(r){case"multi-ring":return(0,a.jsx)(t.MultiRingSpinner,{size:l,className:n});case"dots":return(0,a.jsx)(t.PulsingDotsSpinner,{size:l,className:n});case"gradient":return(0,a.jsx)(t.GradientRingSpinner,{size:l,className:n});case"typing":return(0,a.jsx)(t.TypingIndicator,{className:n});case"message":return(0,a.jsx)(t.ChatMessageLoading,{message:s,className:n});default:return(0,a.jsx)(t.SimpleSpinner,{size:l,className:n})}}},92599:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useStoryStore=void 0;let a=r(87657),l=function(e){return e&&e.__esModule?e:{default:e}}(r(43653));l.default.defaults.withCredentials=!0,l.default.defaults.baseURL="https://chat-app-tk-blg.fly.dev",t.useStoryStore=(0,a.create)(e=>({stories:[],myStoryGroup:null,viewers:[],loading:!1,error:null,selectedStory:null,setSelectedStory:t=>e({selectedStory:t}),isUploadModalOpen:!1,setUploadModalOpen:t=>e({isUploadModalOpen:t}),fetchFriendStories:async()=>{e({loading:!0,error:null});try{let t=await l.default.get("/story/friends");e({stories:t.data.groupedStories,loading:!1})}catch(t){e({error:t instanceof Error?t.message:"Failed to fetch stories",loading:!1})}},fetchMyStories:async()=>{e({loading:!0,error:null});try{let t=await l.default.get("/story/");console.log("My stories response:",t.data),e({myStoryGroup:t.data.userStories,loading:!1})}catch(t){e({error:t instanceof Error?t.message:"Failed to fetch your stories",loading:!1})}},uploadStory:async r=>{e({loading:!0,error:null});try{await l.default.post("/story/upload",r),await Promise.all([t.useStoryStore.getState().fetchFriendStories(),t.useStoryStore.getState().fetchMyStories()])}catch(t){e({error:t instanceof Error?t.message:"Failed to upload story",loading:!1})}},markViewed:async e=>{try{await l.default.post("/story/view/".concat(e))}catch(e){console.error("Failed to mark as viewed",e)}},getStoryViewers:async t=>{e({loading:!0,error:null});try{let r=await l.default.get("/story/view/".concat(t)),a=Array.isArray(r.data.viewers)?r.data.viewers:[];return e({viewers:a,loading:!1}),a}catch(t){return e({error:t instanceof Error?t.message:"Failed to fetch viewers",loading:!1,viewers:[]}),[]}},deleteStory:async r=>{e({loading:!0,error:null});try{await l.default.delete("/story/".concat(r)),await Promise.all([t.useStoryStore.getState().fetchFriendStories(),t.useStoryStore.getState().fetchMyStories()]),e({loading:!1})}catch(t){e({error:t instanceof Error?t.message:"Failed to delete story",loading:!1})}}}))},93019:(e,t,r)=>{"use strict";let a=r(95155);var l=function(e){return e&&e.__esModule?e:{default:e}};let s=l(r(87822)),n=l(r(59782)),i=l(r(91625)),o=l(r(17484));t.A=e=>{let{isOpen:t,handleClose:r,showCreateGroup:l,handleClickOutside:d,showUpdateGroup:c,updateGroupChat:u,handleGroupUpdated:f,showFriendProfile:m}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"".concat(t?"flex":"hidden"," fixed inset-0 z-[1000] bg-navbar-bg flex-col  items-center justify-center overflow-auto"),children:[(0,a.jsx)("button",{onClick:r,className:"text-primary text-3xl font-bold hover:text-red-500 transition-colors p-2","aria-label":"Close",children:"\xd7"}),(0,a.jsx)(s.default,{})]}),(0,a.jsx)("div",{className:"".concat(l?"block":"hidden"," absolute top-0 bottom-0 left-0 right-0 flex justify-center items-center h-full border p-4 md:p-8 z-[100]"),children:(0,a.jsx)(n.default,{handleClickOutside:d})}),(0,a.jsx)("div",{className:"".concat(c?"block":"hidden"," absolute top-0 bottom-0 left-0 right-0 flex justify-center items-center h-full border p-4 md:p-8 z-[100]"),children:u&&(0,a.jsx)(i.default,{handleClickOutside:d,onGroupUpdated:f,group:{id:u.id,name:u.name,participants:u.participants.map(e=>e.id)}})}),(0,a.jsx)("div",{className:"".concat(m?"block":"hidden"," absolute top-0 bottom-0 left-0 right-0 flex justify-center items-center h-full border p-4 md:p-8 z-[100]"),children:u&&(0,a.jsx)(o.default,{chat:{id:u.id,name:u.name,participants:u.participants.map(e=>e.id)},handleClickOutside:d})})]})}},97007:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(95155);var l=Object.create?function(e,t,r,a){void 0===a&&(a=r);var l=Object.getOwnPropertyDescriptor(t,r);(!l||("get"in l?!t.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,l)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]},s=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},n=function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(t)};return function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var a=e(t),n=0;n<a.length;n++)"default"!==a[n]&&l(r,t,a[n]);return s(r,t),r}}();Object.defineProperty(t,"__esModule",{value:!0});let i=n(r(12115));t.default=e=>{let{message:t,handleTimeout:r,handleSendResetLink:l}=e,[s,n]=(0,i.useState)(!0),o=()=>{n(!1),r&&r()};return s?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,a.jsxs)("div",{className:"bg-[#161b22] w-[90%] max-w-md rounded-2xl p-6 shadow-lg relative",children:[(0,a.jsx)("button",{onClick:o,className:"absolute top-4 right-4 text-white text-2xl hover:text-red-500",children:"\xd7"}),(0,a.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,a.jsx)("div",{className:"w-14 h-14 flex items-center justify-center rounded-full bg-gradient-to-br from-red-600 to-red-500 text-white text-2xl mb-4",children:"!"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-white mb-2",children:"Message Failed"}),(0,a.jsx)("p",{className:"text-sm text-gray-400 mb-6",children:t})]}),(0,a.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,a.jsx)("button",{onClick:o,className:"px-6 py-2 rounded-lg border border-gray-600 text-white bg-[#0d1117] hover:bg-[#1a1f2b] transition",children:"Cancel"}),(0,a.jsx)("button",{onClick:l,className:"px-6 py-2 rounded-lg text-white bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 shadow-md hover:shadow-lg transition",children:"Retry"})]})]})}):null}},99082:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFriendsStore=void 0;let a=r(87657),l=function(e){return e&&e.__esModule?e:{default:e}}(r(43653));l.default.defaults.withCredentials=!0,l.default.defaults.baseURL="https://chat-app-tk-blg.fly.dev",t.useFriendsStore=(0,a.create)((e,t)=>({allUsers:[],friends:[],onlineFriends:[],searchResults:[],selectedFriend:null,loading:!1,error:null,fetchAllUsers:async()=>{e({loading:!0,error:null});try{let t=await l.default.get("/friend/all");e({allUsers:t.data.users,loading:!1})}catch(t){e({error:t instanceof Error?t.message:String(t),loading:!1})}},fetchFriends:async()=>{e({loading:!0,error:null});try{let t=await l.default.get("/friend/list");e({friends:t.data.friends,loading:!1})}catch(t){e({error:t instanceof Error?t.message:String(t),loading:!1})}},fetchOnlineFriends:async()=>{e({loading:!0,error:null});try{let t=await l.default.get("/friend/online");e({onlineFriends:t.data.online,loading:!1})}catch(t){e({error:t instanceof Error?t.message:String(t),loading:!1})}},fetchFriendDetails:async t=>{e({loading:!0,error:null});try{let r=(await l.default.get("/friend/details/".concat(t))).data.friend;return e({selectedFriend:r,loading:!1}),r}catch(t){e({error:t instanceof Error?t.message:String(t),loading:!1})}},clearSelectedFriend:()=>e({selectedFriend:null}),searchFriends:async t=>{if(!t.trim())return void e({searchResults:[]});e({loading:!0,error:null});try{let r=await l.default.get("/friend/search?query=".concat(encodeURIComponent(t)));e({searchResults:r.data.results,loading:!1})}catch(t){e({error:t instanceof Error?t.message:String(t),loading:!1})}},getUserSeen:async e=>{try{let{onlineFriends:r}=t();if(r.includes(e))return{status:"online",lastSeen:null};let a=await l.default.get("/friend/status/".concat(e));return{lastSeen:a.data.lastSeen,status:a.data.status}}catch(e){return{lastSeen:null,status:"offline"}}},getUserStatus:async e=>{let{onlineFriends:r}=t();return r.includes(e)?"online":"offline"},addFriend:async r=>{e({loading:!0,error:null});try{await l.default.post("/friend/add",{friendId:r},{headers:{"Content-Type":"application/json"}}),await t().fetchFriends(),await t().fetchOnlineFriends(),e({loading:!1})}catch(r){let t="Unknown error";if(r&&"object"==typeof r){var a,s;"response"in r&&"string"==typeof(null==(s=r.response)||null==(a=s.data)?void 0:a.error)?t=r.response.data.error:"message"in r&&"string"==typeof r.message&&(t=r.message)}e({error:t,loading:!1})}},removeFriend:async r=>{e({loading:!0,error:null});try{await l.default.post("/friend/remove",{friendId:r}),await t().fetchFriends(),await t().fetchOnlineFriends(),e({loading:!1})}catch(t){e({error:t instanceof Error?t.message:String(t),loading:!1})}},clearSearch:()=>e({searchResults:[]})}))}},e=>{var t=t=>e(e.s=t);e.O(0,[568,821,547,855,213,250,441,684,358],()=>t(66663)),_N_E=e.O()}]);
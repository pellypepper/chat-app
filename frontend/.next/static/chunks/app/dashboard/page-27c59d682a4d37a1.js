(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{1231:(e,t,r)=>{"use strict";r.d(t,{F:()=>o,c:()=>n});var a=r(5155),s=r(2115),l=r(4298);let i=(0,s.createContext)({socket:null,socketConnected:!1}),n=()=>(0,s.useContext)(i),o=e=>{let{userId:t,children:r}=e,[n,o]=(0,s.useState)(!1),d=(0,s.useRef)(null);return(0,s.useEffect)(()=>{if(t)return d.current&&(d.current.disconnect(),d.current=null),d.current=(0,l.Ay)("http://localhost:4000",{query:{userId:t.toString()},transports:["websocket","polling"],autoConnect:!0,reconnection:!0,reconnectionDelay:1e3,reconnectionAttempts:5,timeout:2e4}),d.current.on("connect",()=>o(!0)),d.current.on("disconnect",()=>o(!1)),d.current.on("connect_error",()=>o(!1)),()=>{d.current&&(d.current.disconnect(),d.current=null)}},[t]),(0,a.jsx)(i.Provider,{value:{socket:d.current,socketConnected:n},children:r})}},2827:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(5155),s=r(5695),l=r(2115);let i=e=>{let{message:t,showContinueButton:r,handleTimeout:i,url:n,tempState:o}=e,d=(0,s.useRouter)(),[c,u]=l.useState(!0);return c?(0,a.jsx)("div",{id:"success-popup",className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,a.jsxs)("div",{className:"bg-gray-800 text-primary rounded-2xl p-8 max-w-md w-full relative shadow-lg",children:[(0,a.jsx)("button",{onClick:()=>{u(!1),i&&i()},className:"absolute top-3 right-4 text-2xl text-white hover:text-red-400",children:"\xd7"}),(0,a.jsxs)("div",{className:"flex flex-col items-center success-popup",children:[(0,a.jsx)("div",{className:"w-16 h-16 flex items-center justify-center rounded-full bg-gradient-to-br from-green-500 to-green-600 text-white text-3xl mb-4",children:"✓"}),(0,a.jsx)("h2",{className:"text-2xl font-bold mb-2 text-white",children:"Success!"}),(0,a.jsx)("p",{className:"text-sm text-gray-300 text-center",children:t})]}),(0,a.jsxs)("svg",{className:"w-16 h-16 mt-6 mx-auto text-green-500",viewBox:"0 0 52 52",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("circle",{cx:"26",cy:"26",r:"25",stroke:"currentColor",strokeWidth:"2"}),(0,a.jsx)("path",{d:"M14.1 27.2l7.1 7.2 16.7-16.8",stroke:"currentColor",strokeWidth:"2",fill:"none"})]}),r&&(0,a.jsx)("div",{className:"mt-6 text-center",children:(0,a.jsx)("button",{className:"bg-gradient-to-r from-green-500 to-green-600 px-6 py-3 rounded-lg text-white font-semibold hover:shadow-lg transition",onClick:()=>{i&&i();let e=n?o?"".concat(n,"?tempState=").concat(encodeURIComponent(o)):n:"/";d.push(e)},children:"Continue"})})]})}):null}},3328:(e,t,r)=>{Promise.resolve().then(r.bind(r,9780))},4385:(e,t,r)=>{"use strict";r.d(t,{n:()=>i});var a=r(5453),s=r(3464),l=r(6786);s.A.defaults.withCredentials=!0,s.A.defaults.baseURL="https://chat-app-tk-blg.fly.dev";let i=(0,a.v)()((0,l.lt)(e=>({user:null,isAuthenticated:!1,isLoading:!1,error:null,getSession:async()=>{var t,r;try{let r=(await s.A.get("http://localhost:4000/login/user",{withCredentials:!0})).data.user;e({user:r,isAuthenticated:null==(t=null==r?void 0:r.verified)||t,isLoading:!1,error:null})}catch(t){try{await s.A.post("/login/refresh",{},{withCredentials:!0});let t=(await s.A.get("/login/user",{withCredentials:!0})).data.user;e({user:t,isAuthenticated:null==(r=null==t?void 0:t.verified)||r,isLoading:!1,error:null})}catch(t){e({user:null,isAuthenticated:!1,error:"Session expired"})}}},login:async t=>{var r,a,l,i;let{email:n,password:o}=t;e({isLoading:!0,error:null});try{let t=await s.A.post("/login",{email:n,password:o});e({user:t.data.user,isAuthenticated:null!=(a=null==(r=t.data.user)?void 0:r.verified)&&a})}catch(t){e({error:(null==(i=t.response)||null==(l=i.data)?void 0:l.message)||t.message})}finally{e({isLoading:!1})}},googleLogin:()=>{window.location.href="http://localhost:4000/login/google"},logout:async()=>{e({isLoading:!0,error:null});try{await s.A.post("/login/logout"),e({user:null,isAuthenticated:!1,error:null})}catch(a){var t,r;e({error:(null==(r=a.response)||null==(t=r.data)?void 0:t.message)||a.message})}finally{e({isLoading:!1})}},reset:()=>e({user:null,isLoading:!1,error:null})})))},5437:(e,t,r)=>{"use strict";r.d(t,{K:()=>i});var a=r(5453),s=r(3464),l=r(6786);s.A.defaults.withCredentials=!0,s.A.defaults.baseURL="https://chat-app-tk-blg.fly.dev";let i=(0,a.v)()((0,l.lt)(e=>({user:null,isLoading:!1,error:null,message:null,getProfile:async()=>{e({isLoading:!0,error:null,message:null});try{let t=await s.A.get("/profile");e({user:t.data.user,message:null,isLoading:!1})}catch(a){var t,r;e({error:(null==(r=a.response)||null==(t=r.data)?void 0:t.error)||a.message})}finally{e({isLoading:!1})}},updateProfile:async t=>{e({isLoading:!0,error:null,message:null});try{let r=await s.A.put("/profile",t),a=await s.A.get("/profile");e({user:a.data.user,message:r.data.message})}catch(t){var r,a;e({error:(null==(a=t.response)||null==(r=a.data)?void 0:r.error)||t.message})}finally{e({isLoading:!1})}},changePassword:async(t,r)=>{e({isLoading:!0,error:null,message:null});try{let a=await s.A.put("/profile/change-password",{currentPassword:t,newPassword:r});return e({message:a.data.message}),a.data}catch(r){var a,l,i,n;let t=(null==(l=r.response)||null==(a=l.data)?void 0:a.error)||(null==(n=r.response)||null==(i=n.data)?void 0:i.message)||r.message;throw e({error:t}),Error(t)}finally{e({isLoading:!1})}},forgotPassword:async t=>{e({isLoading:!0,error:null,message:null});try{let r=await s.A.post("/profile/forget-password",{email:t});e({message:r.data.message})}catch(t){var r,a;e({error:(null==(a=t.response)||null==(r=a.data)?void 0:r.error)||t.message})}finally{e({isLoading:!1})}},resetPassword:async t=>{let{email:r,token:a,newPassword:l}=t;e({isLoading:!0,error:null,message:null});try{let t=await s.A.post("/profile/reset-password",{email:r,token:a,newPassword:l});e({message:t.data.message})}catch(t){var i,n;e({error:(null==(n=t.response)||null==(i=n.data)?void 0:i.error)||t.message})}finally{e({isLoading:!1})}},uploadProfilePicture:async t=>{e({isLoading:!0,error:null,message:null});let r=new FormData;r.append("image",t);try{let t=await s.A.post("/profile/upload-profile-picture",r,{headers:{"Content-Type":"multipart/form-data"}});e({message:t.data.message}),await i.getState().getProfile()}catch(t){var a,l;e({error:(null==(l=t.response)||null==(a=l.data)?void 0:a.error)||t.message})}finally{e({isLoading:!1})}},clearState:()=>e({isLoading:!1,error:null,message:null})})))},5889:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(5155),s=r(2115);let l=e=>{let{message:t,handleTimeout:r,handleSendResetLink:l}=e,[i,n]=(0,s.useState)(!0),o=()=>{n(!1),r&&r()};return i?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,a.jsxs)("div",{className:"bg-[#161b22] w-[90%] max-w-md rounded-2xl p-6 shadow-lg relative",children:[(0,a.jsx)("button",{onClick:o,className:"absolute top-4 right-4 text-white text-2xl hover:text-red-500",children:"\xd7"}),(0,a.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,a.jsx)("div",{className:"w-14 h-14 flex items-center justify-center rounded-full bg-gradient-to-br from-red-600 to-red-500 text-white text-2xl mb-4",children:"!"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-white mb-2",children:"Message Failed"}),(0,a.jsx)("p",{className:"text-sm text-gray-400 mb-6",children:t})]}),(0,a.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,a.jsx)("button",{onClick:o,className:"px-6 py-2 rounded-lg border border-gray-600 text-white bg-[#0d1117] hover:bg-[#1a1f2b] transition",children:"Cancel"}),(0,a.jsx)("button",{onClick:l,className:"px-6 py-2 rounded-lg text-white bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 shadow-md hover:shadow-lg transition",children:"Retry"})]})]})}):null}},9492:(e,t,r)=>{"use strict";r.d(t,{H5:()=>s});var a=r(5155);let s=e=>{let{size:t="md",className:r=""}=e;return(0,a.jsxs)("div",{className:"relative ".concat({sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16"}[t]," ").concat(r),children:[(0,a.jsx)("div",{className:"absolute inset-0 border-2 border-transparent border-t-[#58a6ff] rounded-full animate-spin"}),(0,a.jsx)("div",{className:"absolute top-1 left-1 right-1 bottom-1 border-2 border-transparent border-t-[#a855f7] rounded-full animate-spin-reverse",style:{animationDuration:"1.5s"}}),(0,a.jsx)("div",{className:"absolute top-2 left-2 right-2 bottom-2 border-2 border-transparent border-t-[#f97316] rounded-full animate-spin",style:{animationDuration:"2s"}})]})}},9780:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>K});var a=r(5155),s=r(2115),l=r(5453),i=r(3464);i.A.defaults.withCredentials=!0,i.A.defaults.baseURL="https://chat-app-tk-blg.fly.dev";let n=(0,l.v)((e,t)=>({chats:[],messages:{},loading:!1,error:null,fetchChatsSummary:async()=>{e({loading:!0,error:null});try{let t=(await i.A.get("/message/message-list")).data.chats;e({chats:t,loading:!1})}catch(t){console.error("Error fetching chats:",t),e({error:t instanceof Error?t.message:"Unknown error",loading:!1})}},fetchMessages:async t=>{e({loading:!0,error:null});try{if(!t)return void e({loading:!1});let r=await i.A.get("/message?chatId=".concat(t));e(e=>({messages:{...e.messages,[t]:r.data.messages},loading:!1}))}catch(t){console.error("Error fetching messages:",t),e({error:t instanceof Error?t.message:"Unknown error",loading:!1})}},createChat:async function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e({loading:!0,error:null});try{let l=await i.A.post("/message/create-chat",{participantIds:r,name:a,isGroup:s});await t().fetchChatsSummary();let n=l.data.chat.id,o=t().chats.find(e=>e.id===n)||null;return e({loading:!1}),o}catch(t){return console.error("Error creating chat:",t),e({error:t instanceof Error?t.message:"Unknown error",loading:!1}),null}},sendMessage:async(t,r,a)=>{e({loading:!0,error:null});try{let s=new FormData;s.append("chatId",t.toString()),r&&s.append("content",r),a&&s.append("image",a);let l=await i.A.post("/message/send-message",s,{headers:{"Content-Type":"multipart/form-data"}});e(e=>({messages:{...e.messages,[t]:[...e.messages[t]||[],l.data.message]},loading:!1}))}catch(t){console.error("Error sending message:",t),e({error:t instanceof Error?t.message:"Unknown error",loading:!1})}},updateGroupChat:async function(r,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];e({loading:!0,error:null});try{await i.A.put("/message/update-group/".concat(r),{name:a,addUserIds:s,removeUserIds:l}),await t().fetchChatsSummary(),e({loading:!1})}catch(t){console.error("Error updating group chat:",t),e({error:t instanceof Error?t.message:"Unknown error",loading:!1})}},deleteMessageEveryone:async(t,r)=>{e({loading:!0,error:null});try{await i.A.delete("/message/delete-user/".concat(r)),e(e=>({messages:{...e.messages,[t]:(e.messages[t]||[]).filter(e=>e.id!==r)},loading:!1}))}catch(t){console.error("Error deleting message for everyone:",t),e({error:t instanceof Error?t.message:"Unknown error",loading:!1})}},deleteChatEveryone:async t=>{e({loading:!0,error:null});try{await i.A.delete("/message/delete-everyone/".concat(t)),e(e=>({chats:e.chats.filter(e=>e.id!==t),messages:Object.fromEntries(Object.entries(e.messages).filter(e=>{let[r]=e;return Number(r)!==t})),loading:!1}))}catch(t){console.error("Error deleting chat for everyone:",t),e({error:t instanceof Error?t.message:"Unknown error",loading:!1})}},clearError:()=>e({error:null})}));var o=r(4385);i.A.defaults.withCredentials=!0,i.A.defaults.baseURL="https://chat-app-tk-blg.fly.dev";let d=(0,l.v)((e,t)=>({allUsers:[],friends:[],onlineFriends:[],searchResults:[],selectedFriend:null,loading:!1,error:null,fetchAllUsers:async()=>{e({loading:!0,error:null});try{let t=await i.A.get("/friend/all");e({allUsers:t.data.users,loading:!1})}catch(t){e({error:t instanceof Error?t.message:String(t),loading:!1})}},fetchFriends:async()=>{e({loading:!0,error:null});try{let t=await i.A.get("/friend/list");e({friends:t.data.friends,loading:!1})}catch(t){e({error:t instanceof Error?t.message:String(t),loading:!1})}},fetchOnlineFriends:async()=>{e({loading:!0,error:null});try{let t=await i.A.get("/friend/online");e({onlineFriends:t.data.online,loading:!1})}catch(t){e({error:t instanceof Error?t.message:String(t),loading:!1})}},fetchFriendDetails:async t=>{e({loading:!0,error:null});try{let r=(await i.A.get("/friend/details/".concat(t))).data.friend;return e({selectedFriend:r,loading:!1}),r}catch(t){e({error:t instanceof Error?t.message:String(t),loading:!1})}},clearSelectedFriend:()=>e({selectedFriend:null}),searchFriends:async t=>{if(!t.trim())return void e({searchResults:[]});e({loading:!0,error:null});try{let r=await i.A.get("/friend/search?query=".concat(encodeURIComponent(t)));e({searchResults:r.data.results,loading:!1})}catch(t){e({error:t instanceof Error?t.message:String(t),loading:!1})}},getUserSeen:async e=>{try{let{onlineFriends:r}=t();if(r.includes(e))return{status:"online",lastSeen:null};let a=await i.A.get("/friend/status/".concat(e));return{lastSeen:a.data.lastSeen,status:a.data.status}}catch(e){return{lastSeen:null,status:"offline"}}},getUserStatus:async e=>{let{onlineFriends:r}=t();return r.includes(e)?"online":"offline"},addFriend:async r=>{e({loading:!0,error:null});try{await i.A.post("/friend/add",{friendId:r},{headers:{"Content-Type":"application/json"}}),await t().fetchFriends(),await t().fetchOnlineFriends(),e({loading:!1})}catch(r){let t="Unknown error";if(r&&"object"==typeof r){var a,s;"response"in r&&"string"==typeof(null==(s=r.response)||null==(a=s.data)?void 0:a.error)?t=r.response.data.error:"message"in r&&"string"==typeof r.message&&(t=r.message)}e({error:t,loading:!1})}},removeFriend:async r=>{e({loading:!0,error:null});try{await i.A.post("/friend/remove",{friendId:r}),await t().fetchFriends(),await t().fetchOnlineFriends(),e({loading:!1})}catch(t){e({error:t instanceof Error?t.message:String(t),loading:!1})}},clearSearch:()=>e({searchResults:[]})}));var c=r(9492);i.A.defaults.withCredentials=!0,i.A.defaults.baseURL="https://chat-app-tk-blg.fly.dev";let u=(0,l.v)(e=>({stories:[],myStoryGroup:null,viewers:[],loading:!1,error:null,selectedStory:null,setSelectedStory:t=>e({selectedStory:t}),isUploadModalOpen:!1,setUploadModalOpen:t=>e({isUploadModalOpen:t}),fetchFriendStories:async()=>{e({loading:!0,error:null});try{let t=await i.A.get("/story/friends");e({stories:t.data.groupedStories,loading:!1})}catch(t){e({error:t instanceof Error?t.message:"Failed to fetch stories",loading:!1})}},fetchMyStories:async()=>{e({loading:!0,error:null});try{let t=await i.A.get("/story/");console.log("My stories response:",t.data),e({myStoryGroup:t.data.userStories,loading:!1})}catch(t){e({error:t instanceof Error?t.message:"Failed to fetch your stories",loading:!1})}},uploadStory:async t=>{e({loading:!0,error:null});try{await i.A.post("/story/upload",t),await Promise.all([u.getState().fetchFriendStories(),u.getState().fetchMyStories()])}catch(t){e({error:t instanceof Error?t.message:"Failed to upload story",loading:!1})}},markViewed:async e=>{try{await i.A.post("/story/view/".concat(e))}catch(e){console.error("Failed to mark as viewed",e)}},getStoryViewers:async t=>{e({loading:!0,error:null});try{let r=await i.A.get("/story/view/".concat(t)),a=Array.isArray(r.data.viewers)?r.data.viewers:[];return e({viewers:a,loading:!1}),a}catch(t){return e({error:t instanceof Error?t.message:"Failed to fetch viewers",loading:!1,viewers:[]}),[]}},deleteStory:async t=>{e({loading:!0,error:null});try{await i.A.delete("/story/".concat(t)),await Promise.all([u.getState().fetchFriendStories(),u.getState().fetchMyStories()]),e({loading:!1})}catch(t){e({error:t instanceof Error?t.message:"Failed to delete story",loading:!1})}}}));var m=r(4416),x=r(2657),h=r(4616),g=r(4355),f=r(2525),p=r(3500),b=r(7213),v=r(9869),y=r(6766);let j=()=>{var e,t;let{uploadStory:r,setUploadModalOpen:l,myStoryGroup:i,fetchMyStories:n,getStoryViewers:o,loading:d,error:c,deleteStory:j}=u(),[w,N]=(0,s.useState)("view"),[C,k]=(0,s.useState)("text"),[S,A]=(0,s.useState)(""),[E,F]=(0,s.useState)(null),[M,L]=(0,s.useState)(null),[U,z]=(0,s.useState)(!1),D=(0,s.useRef)(null),[P,G]=(0,s.useState)({}),[T,O]=(0,s.useState)(!1),[R,I]=(0,s.useState)(null);(0,s.useEffect)(()=>{n()},[n]),(0,s.useEffect)(()=>{(async()=>{if(i&&i.stories){let e={};await Promise.all(i.stories.map(async t=>{let r=await o(t.id);e[t.id]=Array.isArray(r)?r:[]})),G(e)}})()},[i,o]);let B=e=>{F(e),L(URL.createObjectURL(e))},_=async()=>{if("text"===C&&!S.trim()||"image"===C&&!E)return;z(!0);let e=new FormData;e.append("type",C),"text"===C&&e.append("content",S),"image"===C&&E&&e.append("image",E);try{await r(e),l(!1),A(""),F(null),L(null)}catch(e){console.error("Upload failed:",e)}finally{z(!1)}},H=async e=>{await j(e),G(t=>{let r={...t};return delete r[e],r}),console.log("Delete story:",e)},V=e=>{let t=new Date(e),r=Math.floor((new Date().getTime()-t.getTime())/36e5);return r<1?"Just now":r<24?"".concat(r,"h ago"):"".concat(Math.floor(r/24),"d ago")},W=(null==i?void 0:i.stories)||[],Y=async e=>{let t=await o(e);G(r=>({...r,[e]:Array.isArray(t)?t:[]})),I(e),O(!0)};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-gray-900 rounded-2xl w-full max-w-md h-[600px] text-white relative overflow-hidden border border-gray-700",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-700",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:"Your Stories"}),(0,a.jsx)("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-white p-2 hover:bg-gray-800 rounded-full transition-all",children:(0,a.jsx)(m.A,{size:20})})]}),(0,a.jsxs)("div",{className:"flex border-b border-gray-700",children:[(0,a.jsxs)("button",{onClick:()=>N("view"),className:"flex-1 px-6 py-3 text-sm font-medium transition-all ".concat("view"===w?"text-blue-400 border-b-2 border-blue-400 bg-blue-400/10":"text-gray-400 hover:text-white hover:bg-gray-800"),children:[(0,a.jsx)(x.A,{size:16,className:"inline mr-2"}),"View Stories"]}),(0,a.jsxs)("button",{onClick:()=>N("upload"),className:"flex-1 px-6 py-3 text-sm font-medium transition-all ".concat("upload"===w?"text-blue-400 border-b-2 border-blue-400 bg-blue-400/10":"text-gray-400 hover:text-white hover:bg-gray-800"),children:[(0,a.jsx)(h.A,{size:16,className:"inline mr-2"}),"Add Story"]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:"view"===w?(0,a.jsx)("div",{className:"h-full overflow-y-auto p-6",children:d?(0,a.jsx)("p",{className:"text-center text-gray-400",children:"Loading..."}):c?(0,a.jsx)("p",{className:"text-center text-red-500",children:c}):0===W.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[(0,a.jsx)("div",{className:"w-20 h-20 bg-gray-800 rounded-full flex items-center justify-center mb-4",children:(0,a.jsx)(g.A,{size:32,className:"text-gray-400"})}),(0,a.jsx)("p",{className:"text-gray-400 mb-2",children:"No stories yet"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Share your first story with friends"}),(0,a.jsx)("button",{onClick:()=>N("upload"),className:"mt-4 bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-full transition-all",children:"Create Story"})]}):(0,a.jsx)("div",{className:"space-y-4 overflow-y-auto max-h-[400px] scrollbar-thin",children:W.map(e=>{var t,r;return(0,a.jsxs)("div",{className:"bg-gray-800 rounded-xl p-4 border border-gray-700",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-sm",children:"\uD83D\uDC64"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-sm",children:"Your Story"}),(0,a.jsx)("p",{className:"text-gray-400 text-xs",children:V(e.createdAt)})]})]}),(0,a.jsx)("button",{onClick:()=>H(e.id),className:"text-gray-400 hover:text-red-400 p-1 hover:bg-gray-700 rounded transition-all",children:(0,a.jsx)(f.A,{size:16})})]}),"text"===e.type?(0,a.jsx)("div",{className:"bg-gradient-to-br from-blue-600 to-purple-600 rounded-lg p-4 mb-3",children:(0,a.jsx)("p",{className:"text-white text-center font-medium",children:e.content})}):(0,a.jsx)("div",{className:"relative aspect-[3/4] rounded-lg overflow-hidden mb-3",children:(0,a.jsx)(y.default,{src:e.content,fill:!0,alt:"Story",className:"object-cover"})}),(0,a.jsx)("div",{className:"flex items-center gap-4 text-sm text-gray-400",children:(0,a.jsxs)("button",{onClick:()=>Y(e.id),className:"flex items-center gap-1",children:[(0,a.jsx)(x.A,{size:14}),(0,a.jsxs)("span",{children:[null!=(r=null==(t=P[e.id])?void 0:t.length)?r:0," views"]})]})})]},e.id)})})}):(0,a.jsxs)("div",{className:"h-full flex flex-col p-6",children:[(0,a.jsxs)("div",{className:"flex gap-2 mb-6",children:[(0,a.jsxs)("button",{onClick:()=>{k("text"),F(null),L(null)},className:"flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl transition-all ".concat("text"===C?"bg-blue-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700 hover:text-white"),children:[(0,a.jsx)(p.A,{size:18}),(0,a.jsx)("span",{className:"font-medium",children:"Text"})]}),(0,a.jsxs)("button",{onClick:()=>{k("image"),A("")},className:"flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl transition-all ".concat("image"===C?"bg-blue-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700 hover:text-white"),children:[(0,a.jsx)(b.A,{size:18}),(0,a.jsx)("span",{className:"font-medium",children:"Image"})]})]}),(0,a.jsx)("div",{className:"flex-1 mb-6",children:"text"===C?(0,a.jsxs)("div",{className:"h-full",children:[(0,a.jsx)("textarea",{value:S,onChange:e=>A(e.target.value),className:"w-full h-full bg-gray-800 border border-gray-700 rounded-xl p-4 text-white placeholder-gray-400 resize-none focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500",placeholder:"Share what's on your mind...",maxLength:280}),(0,a.jsx)("div",{className:"flex justify-between items-center mt-2",children:(0,a.jsxs)("span",{className:"text-xs text-gray-400",children:[S.length,"/280 characters"]})})]}):(0,a.jsxs)("div",{className:"h-full",children:[(0,a.jsx)("input",{ref:D,type:"file",accept:"image/*",onChange:e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];r&&B(r)},className:"hidden"}),M?(0,a.jsxs)("div",{className:"relative h-full rounded-xl overflow-hidden",children:[(0,a.jsx)(y.default,{src:M,fill:!0,alt:"Preview",className:"object-cover"}),(0,a.jsx)("button",{onClick:()=>{F(null),L(null)},className:"absolute top-3 right-3 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-all",children:(0,a.jsx)(m.A,{size:16})})]}):(0,a.jsxs)("div",{onClick:()=>{var e;return null==(e=D.current)?void 0:e.click()},className:"h-full border-2 border-dashed border-gray-600 rounded-xl flex flex-col items-center justify-center cursor-pointer hover:border-gray-500 hover:bg-gray-800/50 transition-all",children:[(0,a.jsx)(g.A,{size:48,className:"text-gray-400 mb-4"}),(0,a.jsx)("p",{className:"text-gray-400 font-medium mb-2",children:"Choose a photo"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 text-center",children:"Tap to select an image from your device"})]})]})}),(0,a.jsx)("button",{onClick:_,disabled:U||"text"===C&&!S.trim()||"image"===C&&!E,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-4 rounded-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:U?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Uploading..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.A,{size:20}),"Share Story"]})})]})}),T&&null!==R&&(0,a.jsx)("div",{className:"absolute inset-0 bg-black/90 z-20 flex items-end",children:(0,a.jsxs)("div",{className:"w-full max-w-md mx-auto bg-gray-900 rounded-t-3xl p-6 max-h-96 overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-white font-semibold",children:["Viewed by ",null!=(t=null==(e=P[R])?void 0:e.length)?t:0]}),(0,a.jsx)("button",{onClick:()=>O(!1),className:"text-white/70 hover:text-white p-1",children:(0,a.jsx)(m.A,{size:20})})]}),(0,a.jsxs)("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:[(P[R]||[]).map(e=>{var t,r,s,l;return(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center text-lg",children:[null==(r=e.firstname)||null==(t=r[0])?void 0:t.toUpperCase(),null==(l=e.lastname)||null==(s=l[0])?void 0:s.toUpperCase()]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-white font-medium text-sm",children:[e.firstname," ",e.lastname]}),(0,a.jsx)("p",{className:"text-gray-400 text-xs",children:new Date(e.viewedAt).toLocaleString([],{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})},e.id)}),0===(P[R]||[]).length&&(0,a.jsx)("div",{className:"text-center text-gray-400",children:"No viewers yet"})]})]})})]})})};var w=r(2355);let N=()=>{var e;let{stories:t,fetchFriendStories:r,isUploadModalOpen:l,setUploadModalOpen:i,loading:n,error:o,markViewed:d}=u(),[c,x]=(0,s.useState)(null),[h,g]=(0,s.useState)(0),[f,p]=(0,s.useState)(0),[b,v]=(0,s.useState)(!1),[N,C]=(0,s.useState)(null);(0,s.useEffect)(()=>{(()=>{let e=localStorage.getItem("userId");C(e?Number(e):null)})()},[]),(0,s.useEffect)(()=>{r()},[r]),(0,s.useEffect)(()=>{if(!c||null===N)return;let e=c.stories[h],r=c.userId===N,a=t.some(e=>e.userId===c.userId);e&&e.id&&!r&&a&&(d(e.id),console.log("Story marked as viewed 1:",e.id))},[c,h,d,N,t]);let k=(0,s.useCallback)(()=>{c&&(h<c.stories.length-1?g(e=>e+1):(x(null),g(0)))},[c,h]);(0,s.useEffect)(()=>{if(!c)return;let e=setInterval(()=>{p(e=>e>=100?(k(),0):e+2)},100);return()=>clearInterval(e)},[c,h,k]),(0,s.useEffect)(()=>{p(0)},[h]);let S=()=>{h>0?g(e=>e-1):(x(null),g(0))},A=(e,t)=>{e/t<.5?S():k()},E=async e=>{await d(e.stories[0].id),x(e),g(0),p(0),v(!1)},F=c&&null!==N&&c.userId===N;return(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-400 mb-3",children:"Stories"}),n&&(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:"Loading..."}),o&&(0,a.jsx)("p",{className:"text-red-400 text-sm",children:o}),(0,a.jsxs)("div",{className:"flex gap-5 overflow-x-auto pb-2",children:[(0,a.jsxs)("div",{className:"flex-shrink-0 text-center cursor-pointer group",onClick:()=>i(!0),children:[(0,a.jsx)("div",{className:"w-20 h-20 rounded-full flex items-center justify-center text-2xl mb-1 bg-gradient-to-br from-gray-600 to-gray-700 border-2 border-dashed border-gray-500 group-hover:border-gray-400 transition-all duration-200",children:"\uD83D\uDCF7"}),(0,a.jsx)("p",{className:"text-xs text-gray-400 truncate w-20",children:"Your Story"})]}),null==t?void 0:t.map(e=>{let t=function(e){return e.stories&&0!==e.stories.length?e.stories[e.stories.length-1]:null}(e);return(0,a.jsxs)("div",{className:"flex-shrink-0 text-center cursor-pointer group",onClick:()=>E(e),children:[(0,a.jsx)("div",{className:"w-20 h-20 rounded-full border-secondary border   p-0.5 mb-1 group-hover:scale-105 transition-transform duration-200 relative overflow-hidden",children:t&&"image"===t.type?(0,a.jsx)(y.default,{src:t.content,alt:"Preview",fill:!0,className:"object-cover rounded-full"}):(0,a.jsxs)("div",{className:"w-full h-full rounded-full bg-gray-800 flex items-center justify-center text-2xl relative",children:["\uD83D\uDC64",t&&"text"===t.type&&(0,a.jsx)("span",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 text-xs text-white/80 bg-black/60 px-2 rounded",children:t.content.length>12?t.content.slice(0,12)+"...":t.content})]})}),(0,a.jsxs)("p",{className:"text-xs text-gray-400 truncate w-20 group-hover:text-gray-300 transition-colors",children:[e.firstname," ",e.lastname]})]},"story-".concat(e.userId))})]}),c&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black z-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"relative w-full h-full max-w-md mx-auto bg-black",children:[(0,a.jsx)("div",{className:"absolute top-4 left-4 right-4 z-10 flex gap-1",children:c.stories.map((e,t)=>(0,a.jsx)("div",{className:"flex-1 h-1 bg-white/30 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-white rounded-full transition-all duration-100 ease-linear",style:{width:t<h?"100%":t===h?"".concat(f,"%"):"0%"}})},t))}),(0,a.jsxs)("div",{className:"absolute top-8 left-4 right-4 z-10 flex items-center justify-between pt-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 p-0.5",children:(0,a.jsx)("div",{className:"w-full h-full rounded-full bg-gray-800 flex items-center justify-center text-sm",children:"\uD83D\uDC64"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-white font-medium text-sm",children:[c.firstname," ",c.lastname]}),(0,a.jsx)("p",{className:"text-white/70 text-xs",children:new Date(null==(e=c.stories[h])?void 0:e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]}),(0,a.jsx)("button",{className:"text-white/80 hover:text-white p-2 hover:bg-white/10 rounded-full transition-all",onClick:()=>x(null),children:(0,a.jsx)(m.A,{size:20})})]}),(0,a.jsxs)("div",{className:"w-full h-full flex items-center justify-center cursor-pointer relative",onClick:e=>{let t=e.currentTarget.getBoundingClientRect();A(e.clientX-t.left,t.width)},children:[(0,a.jsxs)("div",{className:"absolute inset-0 flex",children:[(0,a.jsx)("div",{className:"w-1/2 h-full"}),(0,a.jsx)("div",{className:"w-1/2 h-full"})]}),(()=>{let e=c.stories[h];return e?"text"===e.type?(0,a.jsx)("div",{className:"flex items-center justify-center h-full px-8",children:(0,a.jsx)("p",{className:"text-white text-xl text-center leading-relaxed font-medium",children:e.content})}):(0,a.jsx)("div",{className:"relative w-full h-full",children:(0,a.jsx)(y.default,{src:e.content,fill:!0,alt:"Story",className:"object-cover",priority:!0})}):null})()]}),!F&&(0,a.jsx)("div",{className:"absolute bottom-4 left-4 right-4 z-10",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsx)("button",{onClick:S,disabled:0===h,className:"text-white/80 hover:text-white disabled:text-white/30 p-2 hover:bg-white/10 rounded-full transition-all disabled:cursor-not-allowed",children:(0,a.jsx)(w.A,{size:20})})})})})]})}),l&&(0,a.jsx)(j,{})]})},C=e=>{let{conversations:t,onChatSelect:r}=e;return(0,a.jsx)("div",{className:"",children:(0,a.jsx)("div",{className:"flex-1 overflow-x-hidden",children:t.map(e=>{var t,s,l;let i=null!=(l=null==e||null==(s=e.name)||null==(t=s[0])?void 0:t.toUpperCase())?l:"?";return(0,a.jsxs)("div",{onClick:()=>r(e.id),className:"flex p-4 justify-between items-center border-b border-gray-600 gap-3 hover:bg-gray-700/30 cursor-pointer transition-all duration-200 ".concat(e.active?"bg-gray-700/50 border-r-4 border-blue-400":""),children:[(0,a.jsxs)("div",{className:"relative w-[45px] h-[45px] rounded-full bg-gradient-purple text-primary flex items-center justify-center font-semibold text-base",children:[e.avatar?(0,a.jsx)(y.default,{width:80,height:80,src:e.avatar,alt:"Profile",className:"w-full h-full rounded-full object-cover"}):i,e.online&&(0,a.jsx)("span",{className:"absolute bottom-0 right-0 w-3 h-3 bg-green-500 border-2 border-primary rounded-full"})]}),(0,a.jsxs)("div",{className:"flex-1 w-[200px]",children:[(0,a.jsx)("div",{className:"font-semibold text-primary",children:e.name}),(0,a.jsx)("div",{className:"text-sm text-gray-400 truncate",children:e.message})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-1 text-xs",children:[(0,a.jsx)("span",{className:"text-gray-400",children:e.time?new Date(e.time).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"}):""}),e.unread>0&&(0,a.jsx)("span",{className:"bg-gradient-orange text-primary font-bold w-5 h-5 flex items-center justify-center rounded-full text-xs",children:e.unread})]})]},e.id)})})})},k=e=>{switch(e){case"online":return"bg-green-500";case"away":return"bg-yellow-500";default:return"bg-gray-500"}},S=(e,t)=>{let{allUsers:r,friends:a,onlineFriends:s}=d.getState(),l=[];switch(e){case"online":l=r.filter(e=>s.includes(e.id));break;case"friends":l=a;break;default:l=r}return l.filter(e=>e.firstname.toLowerCase().includes(t.toLowerCase())||e.lastname.toLowerCase().includes(t.toLowerCase())||e.email.toLowerCase().includes(t.toLowerCase()))},A=e=>{var t,r,s,l;let{user:i,onMessage:n,onAdd:o,onRemove:d,isFriend:c,status:u}=e,m="".concat(((null==i||null==(r=i.firstname)||null==(t=r[0])?void 0:t.toUpperCase())||"")+((null==i||null==(l=i.lastname)||null==(s=l[0])?void 0:s.toUpperCase())||""));return(0,a.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-800/50 rounded-xl hover:bg-gray-800/70 transition-colors",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-purple rounded-full flex items-center justify-center text-primary font-semibold",children:i.profilePicture?(0,a.jsx)(y.default,{width:80,height:80,src:i.profilePicture,alt:"Profile",className:"w-full h-full rounded-full object-cover"}):m}),(0,a.jsx)("div",{className:"absolute bottom-0 right-0 w-3 h-3 ".concat(k(u)," border-2 border-primary rounded-full")})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,a.jsx)("div",{className:"font-semibold text-primary",children:i.firstname}),(0,a.jsx)("div",{className:"flex flex-col gap-2",children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>null==n?void 0:n(i.id),className:"px-3 py-1 bg-[#58a6ff] text-primary  rounded-lg hover:bg-blue-700 transition-colors text-xs",children:"Message"}),d&&(0,a.jsx)("button",{onClick:()=>d(i.id),className:"px-3 py-1 bg-red-600/20 text-red-400 rounded-lg hover:bg-red-600/30 transition-colors text-xs",children:"Remove"})]}):o&&(0,a.jsx)("button",{onClick:()=>o(i.id),className:"px-3 py-1 bg-green-600 text-primary rounded-lg hover:bg-green-700 transition-colors text-xs",children:"Add Friend"})})]})]})},E=e=>{let{activeTab:t,onTabChange:r}=e,s=e=>"px-4 py-2 rounded-t-xl rounded-bl-xl cursor-pointer transition-colors duration-200 text-primary ".concat(t===e?"bg-gradient-purple":"bg-grey hover:bg-[#21262d]");return(0,a.jsx)("nav",{className:"bg-[#0d1117] border-b border-primary text-sm md:text-base",children:(0,a.jsxs)("ul",{className:"flex justify-between items-center px-3 py-2 gap-2",children:[(0,a.jsx)("li",{onClick:()=>r("all"),className:s("all"),children:"All Users"}),(0,a.jsx)("li",{onClick:()=>r("online"),className:s("online"),children:"Online Friends"}),(0,a.jsx)("li",{onClick:()=>r("friends"),className:s("friends"),children:"My Friends"})]})})},F=e=>{let{value:t,onChange:r}=e;return(0,a.jsx)("div",{className:"px-5 pb-5",children:(0,a.jsx)("input",{className:"w-full px-4 py-3 bg-tertiary-bg border text-primary border-primary mt-3 h-[50px] rounded text-sm focus:outline-none focus:border-[#58a6ff] focus:ring-4 focus:ring-[#58a6ff]/20",type:"text",value:t,onChange:e=>r(e.target.value),placeholder:"Search friends by name or email"})})};var M=r(1231);let L=e=>{let{onChatSelect:t}=e,{allUsers:r,friends:l,loading:i,error:c,fetchFriends:u,fetchOnlineFriends:m,addFriend:x,removeFriend:h,searchFriends:g,clearSearch:f}=d(),{fetchChatsSummary:p,createChat:b}=n(),[v,y]=(0,s.useState)({}),j=n.getState().chats.map(e=>({...e,participants:e.participants.map(e=>{var t;return{id:e.id,name:null!=(t=e.name)?t:""}}),lastMessage:null===e.lastMessage?void 0:e.lastMessage,lastMessageAt:null===e.lastMessageAt?void 0:e.lastMessageAt})),w=(0,o.n)(e=>e.user),[N,C]=(0,s.useState)("all"),[k,L]=(0,s.useState)(""),{socket:U}=(0,M.c)(),z=(0,s.useCallback)(()=>{let e=d.getState().onlineFriends,t=[];t=k.trim()?d.getState().searchResults:S(N,"");let r={};t.forEach(t=>{r[t.id]=e.includes(t.id)?"online":"offline"}),y(r)},[N,k]);(0,s.useEffect)(()=>{if(!(null==w?void 0:w.id)||!U)return;let e=()=>{m(),z()};return U.on("user_online",e),U.on("user_offline",e),m(),()=>{U.off("user_online",e),U.off("user_offline",e)}},[null==w?void 0:w.id,m,z,U]),(0,s.useEffect)(()=>{z()},[z]),(0,s.useEffect)(()=>{k.trim()?g(k):f()},[k,g,f]);let D=k.trim()?d.getState().searchResults:r,P=S(N,k).filter(e=>D.some(t=>t.id===e.id)),G=async e=>{await x(e),await u(),await m()},T=async e=>{await h(e),await u(),await m(),await p()},O=async e=>{try{if(!(null==w?void 0:w.id))throw Error("User not authenticated");let s=j.find(t=>{if(!Array.isArray(t.participants)||2!==t.participants.length)return!1;let r=t.participants.map(e=>e.id).sort(),a=[w.id,e].sort();return!t.isGroup&&r[0]===a[0]&&r[1]===a[1]});if(s)return void t(s.id,s);let l=await b([e],void 0,!1);if(l){var r,a;let e={...l,participants:(l.participants||[]).map(e=>{var t,r,a;return{id:e.id,name:null!=(a=null!=(r=null!=(t=e.name)?t:e.firstname)?r:e.lastname)?a:""}}),lastMessage:null!=(r=l.lastMessage)?r:void 0,lastMessageAt:null!=(a=l.lastMessageAt)?a:void 0};t(Number(e.id),e);return}await p(),setTimeout(()=>{let r=(n.getState().chats||[]).find(t=>Array.isArray(t.participants)&&t.participants.some(t=>(null==t?void 0:t.id)===e));if(r){var a,s;let e={...r,participants:r.participants.map(e=>{var t,r,a;return{id:e.id,name:null!=(a=null!=(r=null!=(t=e.name)?t:e.firstname)?r:e.lastname)?a:""}}),lastMessage:null!=(a=r.lastMessage)?a:void 0,lastMessageAt:null!=(s=r.lastMessageAt)?s:void 0};t(e.id,e)}},100)}catch(e){console.error("Error in handleMessage:",e)}};return(0,a.jsxs)("div",{className:"flex flex-col h-full min-h-0 max-h-screen",children:[(0,a.jsx)(F,{value:k,onChange:L}),(0,a.jsx)(E,{activeTab:N,onTabChange:C}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto scrollbar-auto-hide p-4 space-y-3",children:[i&&(0,a.jsx)("div",{className:"text-center text-gray-400",children:"Loading..."}),c&&(0,a.jsx)("div",{className:"text-center text-red-500",children:c}),!i&&!c&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-primary",children:"all"===N?"All Users (A–Z)":"online"===N?"Online Friends":"My Friends"}),(0,a.jsxs)("span",{className:"text-sm text-gray-400",children:[P.length," users"]})]}),P.length?P.map(e=>{let t=l.some(t=>t.id===e.id),r=v[e.id]||"offline";return(0,a.jsx)(A,{isFriend:t,user:e,status:r,onMessage:t?()=>O(e.id):void 0,onAdd:t?void 0:()=>G(e.id),onRemove:t?()=>T(e.id):void 0},e.id)}):(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"text-gray-400 mb-2",children:"No results found"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Try adjusting your search or browse different categories"})]})]})]})]})},U=e=>{let{size:t=24,color:r="currentColor"}=e;return(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:r,width:t,height:t,className:"cursor-pointer",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a4 4 0 00-4-4h-1m-8 6h5v-2a4 4 0 00-4-4H7m6-6a4 4 0 11-8 0 4 4 0 018 0zm6 0a4 4 0 11-8 0 4 4 0 018 0z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v8m4-4H8"})]})};var z=r(5695),D=r(2827),P=r(5889);let G=e=>{var t,r,l,i;let{handleGroup:d,handleClick:u,onChatSelect:m}=e,[x,h]=(0,s.useState)("Messages"),[g,f]=(0,s.useState)(!1),[p,b]=(0,s.useState)(!1),v=(0,z.useRouter)(),{logout:y,isLoading:j,user:w,error:k}=(0,o.n)(),{chats:S}=n(),A=async()=>{try{await y(),f(!0),setTimeout(()=>{v.push("/withNavpages")},2e3)}catch(e){b(!0)}};return(0,a.jsxs)("section",{className:" p-4 h-screen bg-primary-bg flex flex-col",children:[(0,a.jsxs)("div",{className:"flex justify-between p-5 items-center mb-4",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-icon text-primary flex items-center justify-center font-semibold",children:((null==w||null==(r=w.firstname)||null==(t=r[0])?void 0:t.toUpperCase())||"")+((null==w||null==(i=w.lastname)||null==(l=i[0])?void 0:l.toUpperCase())||"")}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("p",{onClick:u,className:"text-primary text-xl md:text-2xl cursor-pointer",children:"⚙️"}),(0,a.jsx)("p",{onClick:A,className:"text-primary text-xl md:text-2xl cursor-pointer",children:"⏻"})]})]}),(0,a.jsx)("nav",{className:"border-b border-primary",children:(0,a.jsx)("ul",{className:"flex justify-between items-center w-full relative",children:["Messages","Friends","Group"].map(e=>(0,a.jsx)("li",{className:"flex-1",children:(0,a.jsxs)("button",{onClick:()=>h(e),className:"w-full p-4 text-center transition-all duration-200 relative ".concat(x===e?"text-primary font-semibold":"text-gray-400 hover:text-gray-300"),children:[e,x===e&&(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-purple rounded-full"})]})},e))})}),(0,a.jsxs)("section",{className:"flex-1 flex flex-col min-h-0",children:["Messages"===x&&(0,a.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,a.jsx)("div",{className:"p-4 flex-shrink-0",children:(0,a.jsx)(N,{})}),(0,a.jsx)("div",{className:"flex-1 border-t  border-primary overflow-y-auto scrollbar-auto-hide px-5",children:S.length>0?(0,a.jsx)(C,{onChatSelect:m,conversations:S.filter(e=>!e.isGroup).map(e=>{let t=e.participants.find(e=>e.profilePicture);return{id:Number(e.id),name:e.name,avatar:t?t.profilePicture:"",message:e.lastMessage||"",time:e.lastMessageAt||"",unread:0}})}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center mt-16 text-center text-secondary",children:[(0,a.jsxs)("svg",{width:64,height:64,viewBox:"0 0 64 64",fill:"none",className:"mb-4",children:[(0,a.jsx)("circle",{cx:"32",cy:"32",r:"32",fill:"#23272F"}),(0,a.jsx)("path",{d:"M22 28a10 10 0 0 1 20 0v4a10 10 0 0 1-20 0v-4Z",stroke:"#A855F7",strokeWidth:"2"}),(0,a.jsx)("circle",{cx:"26",cy:"32",r:"2",fill:"#58A6FF"}),(0,a.jsx)("circle",{cx:"38",cy:"32",r:"2",fill:"#58A6FF"}),(0,a.jsx)("rect",{x:"28",y:"38",width:"8",height:"2",rx:"1",fill:"#A855F7"})]}),(0,a.jsx)("h2",{className:"text-lg font-semibold text-primary mb-1",children:"No Conversations Yet"}),(0,a.jsx)("p",{className:"text-sm text-secondary max-w-xs",children:"Start a chat with your friends or contacts to see your conversations here."})]})})]}),"Friends"===x&&(0,a.jsx)("div",{className:"p-5",children:(0,a.jsx)(L,{onChatSelect:m})}),"Group"===x&&(0,a.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,a.jsx)("div",{className:"p-5 flex-shrink-0",children:(0,a.jsx)("div",{className:"p-2 mt-2 flex justify-center",children:(0,a.jsxs)("button",{onClick:d,className:"flex justify-center items-center gap-2 bg-gradient-purple text-primary font-semibold px-5 py-3 rounded-lg shadow-lg hover:brightness-110 transition duration-300 ease-in-out",children:[(0,a.jsx)(U,{size:24,color:"white"}),"Create Group"]})})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto scrollbar-auto-hide px-5",children:S.length>0?(0,a.jsx)(C,{onChatSelect:m,conversations:S.filter(e=>e.isGroup).map(e=>({id:Number(e.id),name:e.name,avatar:"",message:e.lastMessage||"",time:e.lastMessageAt||"",unread:0}))}):(0,a.jsxs)("div",{className:"text-center text-gray-400",children:[(0,a.jsx)("p",{className:"text-lg font-semibold",children:"No Groups Available"}),(0,a.jsx)("p",{className:"text-sm",children:"Create or join a group to start chatting!"})]})})]})]}),j&&(0,a.jsx)("div",{className:"fixed inset-0 z-60 flex items-center justify-center bg-black bg-opacity-60",children:(0,a.jsx)(c.H5,{})}),g&&(0,a.jsx)(D.A,{message:"Logout successful! Redirecting to homepage in 3 seconds...",handleTimeout:()=>{},url:"/withNavpages",tempState:null}),p&&(0,a.jsx)(P.A,{message:k||"Logout failed. Please try again.",handleTimeout:()=>{b(!1)}})]})};var T=r(7550);let O=e=>{var t,r,l;let{chat:i,handleUpdateOpen:c,onBack:u}=e,{fetchMessages:m,messages:x,fetchChatsSummary:h,sendMessage:g,deleteChatEveryone:f,deleteMessageEveryone:p}=n(),b=(0,o.n)(e=>e.user),v=null==b?void 0:b.id,{onlineFriends:j,getUserSeen:w}=d(),{socket:N}=(0,M.c)(),C=(0,s.useMemo)(()=>i&&x[i.id]||[],[i,x]),k=(0,s.useRef)(null),[S,A]=(0,s.useState)(""),[E,F]=(0,s.useState)(null),[L,U]=(0,s.useState)(!1),[z,D]=(0,s.useState)(null),P=i&&i.participants&&2===i.participants.length&&v?null==(t=i.participants.find(e=>e.id!==v))?void 0:t.id:null;(0,s.useEffect)(()=>{if(!N||!(null==i?void 0:i.id))return;let e=e=>{let{message:t}=e;t&&i&&t.chatId===i.id&&m(i.id)};return N.on("new_message",e),N.emit("join_chat",i.id),m(i.id),()=>{N.emit("leave_chat",i.id),N.off("new_message",e)}},[i,m,N]),(0,s.useEffect)(()=>{var e;null==(e=k.current)||e.scrollIntoView({behavior:"smooth"})},[C,i]);let[G,O]=(0,s.useState)("Offline"),[R,I]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=!0;return async function(){if(i&&i.participants&&2===i.participants.length&&P){let r=j.includes(P);if(I(r),r)O("Active now"),D(null);else try{let r=await w(P);if(e){var t;D(null!=(t=null==r?void 0:r.lastSeen)?t:null),O((null==r?void 0:r.lastSeen)?"Last seen: ".concat(function(e){if(!e)return"";let t=new Date(e),r=new Date().getTime()-t.getTime();return r<6e4?"just now":r<36e5?"".concat(Math.floor(r/6e4)," min ago"):r<864e5?"".concat(Math.floor(r/36e5)," hours ago"):t.toLocaleString()}(r.lastSeen)):"Offline")}}catch(t){e&&(D(null),O("Offline"))}}else i&&i.participants&&i.participants.length>2?(D(null),O(""),I(!1)):(O("Connecting..."),D(null))}(),()=>{e=!1}},[i,j,w,v,P]);let B=async()=>{if((S.trim()||E)&&i){U(!0);try{await g(i.id,S.trim()?S:void 0,E||void 0),await h(),A(""),F(null)}catch(e){}finally{U(!1)}}},_=async(e,t)=>{if(e&&t)try{await p(e,t)}catch(e){}},H=async e=>{if(e)try{await f(e),u()}catch(e){}},V=e=>{c(e)},W=e=>!!e&&"string"==typeof e&&(!!(e.includes("pelly-chat.s3.")&&/\.(jpg|jpeg|png|gif|webp)$/i.test(e))||/\.(jpg|jpeg|png|gif|webp)(\?.*)?$/i.test(e)),Y=(0,a.jsx)("div",{className:"absolute bottom-0 right-0 w-2 h-2 rounded-full border border-white ".concat(R?"bg-green-500":"bg-gray-400")}),q={};return i&&i.participants&&i.participants.length>2&&i.participants.forEach(e=>{e.id!==v&&(q[e.id]=j.includes(e.id)?"online":"offline")}),(0,a.jsx)("div",{className:"p-4 ",children:(0,a.jsx)("div",{className:"flex flex-col flex-1 h-screen",children:i?(0,a.jsxs)("div",{className:"flex flex-col flex-1 h-screen",children:[(0,a.jsxs)("div",{className:"p-5 border-b border-primary flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("button",{onClick:u,className:"md:hidden text-xs text-primary mb-4",children:(0,a.jsx)(T.A,{className:"w-5 h-5 text-primary "})}),(0,a.jsxs)("div",{className:"relative w-8 h-8 rounded-full bg-gradient-purple flex items-center justify-center text-primary text-xs font-semibold",children:[null!=(l=null==i||null==(r=i.name)?void 0:r[0])?l:"?",i&&i.participants&&2===i.participants.length&&Y]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"mb-1 font-semibold text-primary",children:i?i.name:""}),(0,a.jsx)("div",{className:"text-secondary text-sm flex items-center gap-2",children:i&&i.participants&&2===i.participants.length?(0,a.jsxs)(a.Fragment,{children:[R?(0,a.jsx)("span",{className:"text-green-500",children:"Online"}):(0,a.jsx)("span",{className:"text-gray-400",children:G}),z&&!R&&(0,a.jsx)("span",{className:"text-xs text-gray-500"})]}):i&&i.participants&&i.participants.length>2?(0,a.jsx)("span",{className:"text-gray-400",children:"Group Chat"}):""})]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:()=>V(i),className:"w-10 h-10 rounded-full bg-tertiary-bg hover:bg-primary  text-secondary hover:text-primary flex items-center justify-center transition",children:"ℹ️"}),(0,a.jsx)("button",{className:"w-10 h-10 rounded-full bg-red-600 hover:bg-red-800 text-white flex items-center justify-center transition",title:"Delete Chat",onClick:()=>{(null==i?void 0:i.id)!==void 0&&H(i.id)},children:"\uD83D\uDDD1️"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-4 p-5 overflow-y-auto flex-1 scrollbar-hidden",children:[0===C.length&&(0,a.jsx)("div",{className:"text-secondary text-center mt-10",children:"No messages yet."}),C.map((e,t)=>{var r,s,l;let n=e.senderId===v,o="image"===e.type||W(e.content),d=null==i||null==(r=i.participants)?void 0:r.find(t=>t.id===e.senderId),c=n?(null==b?void 0:b.firstname)||"You":(null==d?void 0:d.name)||"Unknown",u=n?(null==b||null==(s=b.firstname)?void 0:s[0])||"Y":(null==d||null==(l=d.name)?void 0:l[0])||"U",m=null;return i&&i.participants&&i.participants.length>2&&d&&d.id!==v&&(m="online"===q[d.id]?"Online":"Offline"),(0,a.jsxs)("div",{className:"flex gap-3 max-w-[70%] ".concat(n?"self-start flex-row":"self-end flex-row-reverse"),children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-semibold \n                  ".concat(n?"bg-gradient-to-br from-[#58a6ff] to-[#a855f7]":"bg-gradient-to-br from-[#6366f1] to-[#8b5cf6]"," flex-shrink-0"),children:u}),(0,a.jsxs)("div",{className:"flex flex-col",children:[m&&(0,a.jsx)("div",{className:"text-xs mt-1 text-[#a3a3a3] text-right",children:m}),(0,a.jsx)("div",{className:"text-xs mb-1 ml-2 ".concat(n?"text-[#7d8590] text-left":"text-[#7d8590] text-right"),children:c}),(0,a.jsxs)("div",{className:"px-4 py-3 rounded-xl relative group ".concat(n?"bg-gradient-to-br from-[#58a6ff] to-[#a855f7] text-white rounded-bl-sm":"bg-[#21262d] border border-[#30363d] text-white rounded-br-sm"),children:[(0,a.jsx)("div",{children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.default,{src:e.content,alt:"sent image",width:320,height:240,className:"max-w-xs rounded-lg mb-1",style:{width:"auto",height:"auto",maxWidth:"20rem",maxHeight:"15rem"},unoptimized:!0,onError:e=>{let t=e.target;t.style.display="none",t.nextSibling instanceof HTMLElement&&(t.nextSibling.style.display="block")}}),(0,a.jsx)("span",{style:{display:"none"},children:e.content})]}):(0,a.jsx)("span",{children:e.content})}),(0,a.jsxs)("div",{className:"text-xs mt-2 ".concat(n?"text-white/70":"text-[#7d8590]"),children:[e.createdAt?new Date(e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",n&&(0,a.jsx)("span",{className:"ml-2",children:"✓✓"})]}),(0,a.jsx)("div",{className:"absolute top-2 ".concat(n?"left-2":"right-2"," opacity-0 group-hover:opacity-100 flex gap-2"),children:(0,a.jsx)("button",{title:"Delete for everyone",className:"text-xs px-2 py-1 bg-black/20 rounded hover:bg-red-600 hover:text-white transition-colors",onClick:()=>_(i.id,e.id),children:"\uD83D\uDDD1️"})})]})]})]},e.id||t)}),(0,a.jsx)("div",{ref:k})]}),(0,a.jsx)("div",{className:"p-5 border-t border-[#30363d]",children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),B()},className:"flex items-center gap-3 bg-[#21262d] border border-[#30363d] rounded-full px-5 py-3",children:[(0,a.jsx)("div",{className:"flex gap-2 text-[#7d8590]",children:(0,a.jsxs)("label",{className:"hover:text-[#58a6ff] transition cursor-pointer",children:["\uD83D\uDCCE",(0,a.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{e.target.files&&e.target.files[0]&&F(e.target.files[0])},disabled:L})]})}),(0,a.jsx)("input",{type:"text",placeholder:"Type your message...",className:"flex-1 bg-transparent text-primary focus:outline-none text-base placeholder-[#7d8590]",value:S,onChange:e=>A(e.target.value),disabled:L}),E&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(y.default,{src:URL.createObjectURL(E),alt:"preview",width:40,height:40,className:"w-10 h-10 object-cover rounded-full mr-2"}),(0,a.jsx)("button",{type:"button",onClick:()=>F(null),className:"text-red-500 text-xs",children:"✕"})]}),(0,a.jsx)("button",{type:"submit",className:"w-8 h-8 rounded-full bg-gradient-to-br from-[#58a6ff] to-[#a855f7] text-white hover:scale-110 transition",disabled:L||!S.trim()&&!E,title:"Send",children:"➤"})]})})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center px-4",children:[(0,a.jsx)("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-[#58a6ff] to-[#a855f7] flex items-center justify-center text-white text-4xl mb-4 shadow-lg",children:"\uD83D\uDCAC"}),(0,a.jsx)("h1",{className:"text-2xl font-semibold text-gradient-purple mb-2",children:"Select a chat"}),(0,a.jsx)("p",{className:"text-secondary text-sm max-w-xs",children:"Choose a conversation from the left panel to start messaging."})]})})})},R=e=>{let{selectedChat:t,handleUpdateOpen:r,handleBack:s,handleGroup:l,handleChatSelect:i,handleClick:n}=e;return(0,a.jsx)("div",{className:"md:hidden overflow-hidden ",children:t?(0,a.jsx)(O,{chat:t,handleUpdateOpen:r,onBack:s}):(0,a.jsx)(G,{handleGroup:l,onChatSelect:i,handleClick:n})})},I=e=>{let{selectedChat:t,handleUpdateOpen:r,handleBack:s,handleGroup:l,handleChatSelect:i,handleClick:n}=e;return(0,a.jsxs)("div",{className:"hidden md:grid md:grid-cols-[30%_70%] overflow-hidden",children:[(0,a.jsx)("div",{className:"overflow-hidden",children:(0,a.jsx)(G,{handleGroup:l,onChatSelect:i,handleClick:n})}),(0,a.jsx)("div",{className:"overflow-hidden",children:(0,a.jsx)(O,{onBack:s,handleUpdateOpen:r,chat:t})})]})};var B=r(5437);let _=()=>{let{getProfile:e,user:t,updateProfile:r,uploadProfilePicture:l,isLoading:i}=(0,B.K)(),[o,c]=(0,s.useState)(""),[u,m]=(0,s.useState)(""),[x,h]=(0,s.useState)(""),[f,p]=(0,s.useState)(null),{friends:b}=d(),v=(0,z.useRouter)(),{chats:j}=n();(0,s.useEffect)(()=>{(async()=>{await e()})()},[e]),(0,s.useEffect)(()=>{t&&(c(t.firstname),m(t.lastname),h(t.email),p(t.profilePicture||""))},[t]);let w=j.filter(e=>e.isGroup),N=async e=>{e.preventDefault();try{console.log("Updating profile with:",{firstName:o,lastName:u,email:x}),await r({firstname:o,lastname:u,email:x}),console.log("Profile updated successfully")}catch(e){console.error("Failed to update profile:",e),alert("Error updating profile. Please try again.")}},C=(0,s.useRef)(null),k="".concat((null==o?void 0:o[0])||"").concat((null==u?void 0:u[0])||"");return(0,a.jsxs)("div",{id:"profile",children:[(0,a.jsxs)("div",{className:"text-center  mb-6 pt-4",children:[(0,a.jsx)("h1",{className:"bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent text-3xl font-bold mb-2",children:"Profile"}),(0,a.jsx)("p",{className:"text-secondary",children:"Manage your personal information"})]}),(0,a.jsxs)("div",{className:"bg-[#161b22]/80 border border-primary rounded-2xl p-6 mb-4 relative overflow-hidden text-center backdrop-blur-lg",children:[(0,a.jsx)("div",{className:"absolute top-0 left-0 right-0 h-20 bg-gradient-purple opacity-10"}),(0,a.jsxs)("div",{className:"w-20 h-20 rounded-full border-4 border-blue-400 mx-auto bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center text-3xl text-white cursor-pointer overflow-hidden relative z-10",onClick:()=>{var e;null==(e=C.current)||e.click()},children:[(0,a.jsx)("input",{type:"file",accept:"image/*",ref:C,onChange:e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];r&&l(r)},className:"hidden"}),f?(0,a.jsx)(y.default,{width:80,height:80,src:f,alt:"Profile",className:"w-full h-full object-cover"}):k,(0,a.jsx)("div",{className:"absolute bottom-0 z-[1000] right-1 bg-black/60 rounded-full p-1 flex items-center justify-center ",children:(0,a.jsx)(g.A,{className:"w-5 h-5 text-white"})})]}),(0,a.jsxs)("div",{className:"text-xl font-bold mt-2",children:[o," ",u]}),(0,a.jsxs)("div",{className:"flex justify-around pt-4 border-t border-primary",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-xl font-bold text-blue-400",children:b.length}),(0,a.jsx)("div",{className:"text-secondary text-sm",children:"Friends"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-xl font-bold text-blue-400",children:w.length}),(0,a.jsx)("div",{className:"text-secondary text-sm",children:"Groups"})]})]})]}),(0,a.jsxs)("form",{onSubmit:N,className:"bg-[#161b22]/80 border border-primary rounded-2xl p-6 mb-4 backdrop-blur-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Edit Profile"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block mb-2 font-medium",children:"First Name"}),(0,a.jsx)("input",{type:"text",className:"w-full p-3 bg-primary border border-primary rounded-lg text-base focus:outline-none focus:border-blue-400 focus:ring-2 focus:ring-blue-400/10",value:o,onChange:e=>c(e.target.value),placeholder:"Enter your first name"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block mb-2 font-medium",children:"Last Name"}),(0,a.jsx)("input",{type:"text",className:"w-full p-3 bg-primary border border-primary rounded-lg text-base focus:outline-none focus:border-blue-400 focus:ring-2 focus:ring-blue-400/10",value:u,onChange:e=>m(e.target.value),placeholder:"Enter your last name"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block mb-2 font-medium",children:"Email"}),(0,a.jsx)("input",{type:"email",className:"w-full p-3 bg-primary border border-primary rounded-lg text-base focus:outline-none focus:border-blue-400 focus:ring-2 focus:ring-blue-400/10",value:x,onChange:e=>h(e.target.value),placeholder:"Enter your email"})]}),(0,a.jsxs)("button",{type:"button",onClick:()=>v.push("/change-password"),className:"w-full flex items-center justify-center gap-2 bg-gradient-purple text-primary py-2 px-6 rounded-lg font-semibold hover:translate-y-[-2px] hover:shadow-lg transition disabled:opacity-50",children:[(0,a.jsx)("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:(0,a.jsx)("path",{d:"M3 8a5 5 0 1 1 9.584 1H16v2h-2v2h-2v-2H9v-2.416A5 5 0 0 1 3 8zm5-3a3 3 0 1 0 0 6 3 3 0 0 0 0-6z"})}),"Change password"]}),(0,a.jsxs)("button",{type:"submit",disabled:i,className:"w-full mt-2 flex items-center justify-center gap-2 bg-gradient-purple text-primary py-2 px-6 rounded-lg font-semibold hover:translate-y-[-2px] hover:shadow-lg transition disabled:opacity-50",children:[(0,a.jsx)("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:(0,a.jsx)("path",{d:"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708L9.708 9H2.5A1.5 1.5 0 0 0 1 10.5v.5a.5.5 0 0 0 .5.5h.5a.5.5 0 0 1 .5.5v.5a.5.5 0 0 0 .5.5h.5a.5.5 0 0 1 .5.5v.5a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5V14h1.5a.5.5 0 0 0 .5-.5v-2.293L15.854 3.854a.5.5 0 0 0 0-.708l-3-3z"})}),i?"Saving...":"Save Changes"]})]})]})},H=e=>{let{handleClickOutside:t}=e,r=d(e=>e.friends),{createChat:l,chats:i}=n(),o=r&&r.length>0?r:[],[u,m]=(0,s.useState)(""),[x,h]=(0,s.useState)([]),[g,f]=(0,s.useState)(!1),[p,b]=(0,s.useState)(!1),[v,y]=(0,s.useState)(!1),[j,w]=(0,s.useState)(!1),[N,C]=(0,s.useState)(""),k=e=>{h(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},S=async e=>{if(e.preventDefault(),u.trim()&&x.length>0){let e=u.trim(),r=x.length>=2;if(i.map(e=>e.name).includes(e)){C("A group with this name already exists. Please choose a different name."),w(!0),setTimeout(()=>w(!1),3e3);return}b(!0);try{await new Promise(e=>setTimeout(e,3e3));let a=await l(x,e,r);b(!1),a?(y(!0),setTimeout(()=>{y(!1),t()},2e3)):(C("Error creating group."),w(!0),setTimeout(()=>w(!1),3e3))}catch(e){b(!1),C("Error creating group."),w(!0),setTimeout(()=>w(!1),3e3)}}},A=o.filter(e=>x.includes(e.id)).map(e=>"".concat(e.firstname," ").concat(e.lastname));return(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{backgroundColor:"rgba(13, 17, 23, 0.8)"},onClick:t,children:[p&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-70 z-50 rounded-lg",children:(0,a.jsx)(c.H5,{})}),v&&(0,a.jsx)(D.A,{message:"Group created!"}),j&&(0,a.jsx)(P.A,{message:N||"Error creating group."}),(0,a.jsx)("div",{className:"relative w-full bg-navbar-bg border-primary border max-w-md rounded-lg shadow-2xl backdrop-blur-sm",onClick:e=>e.stopPropagation(),children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-2 bg-gradient-to-r bg-clip-text text-transparent",style:{backgroundImage:"linear-gradient(90deg, var(--gradient-blue, #58a6ff), var(--gradient-purple, #a855f7))"},children:"Create Group"}),(0,a.jsx)("p",{style:{color:"var(--text-secondary, #7d8590)"},className:"text-sm",children:"Start a new conversation with your team"})]}),(0,a.jsxs)("form",{onSubmit:S,className:"space-y-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"groupName",className:"block text-primary text-sm font-medium mb-2",children:"Group Name *"}),(0,a.jsx)("input",{type:"text",id:"groupName",name:"groupName",required:!0,value:u,onChange:e=>m(e.target.value),placeholder:"Enter group name...",className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-red-500 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-opacity-50 text-sm",style:{backgroundColor:"var(--tertiary-bg, #21262d)",borderColor:"var(--border, #30363d)",color:"var(--text-primary, #e6edf3)"},onFocus:e=>{e.target.style.borderColor="var(--gradient-blue, #58a6ff)",e.target.style.boxShadow="0 0 0 3px rgba(88, 166, 255, 0.1)"},onBlur:e=>{e.target.style.borderColor="var(--border, #30363d)",e.target.style.boxShadow="none"},disabled:p})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"friendsSelect",className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary, #e6edf3)"},children:"Add Friends *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>f(!g),className:"w-full px-4 py-3 rounded-lg border transition-all duration-200 focus:outline-none text-sm text-left flex items-center justify-between",style:{backgroundColor:"var(--tertiary-bg, #21262d)",borderColor:x.length>0?"var(--gradient-blue, #58a6ff)":"var(--border, #30363d)",color:"var(--text-primary, #e6edf3)"},disabled:p,children:[(0,a.jsx)("div",{className:"flex-1",children:0===x.length?(0,a.jsx)("span",{style:{color:"var(--text-secondary, #7d8590)"},children:"Select friends to add..."}):(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[A.slice(0,2).map((e,t)=>(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs",style:{backgroundColor:"var(--overlay-light, rgba(88, 166, 255, 0.1))",color:"var(--gradient-blue, #58a6ff)"},children:e},t)),x.length>2&&(0,a.jsxs)("span",{className:"px-2 py-1 rounded text-xs",style:{backgroundColor:"var(--overlay-purple, rgba(168, 85, 247, 0.1))",color:"var(--gradient-purple, #a855f7)"},children:["+",x.length-2," more"]})]})}),(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",className:"transition-transform duration-200 ".concat(g?"rotate-180":""),style:{color:"var(--text-secondary, #7d8590)"},children:(0,a.jsx)("path",{d:"M4.427 7.427l3.396 3.396a.25.25 0 00.354 0l3.396-3.396A.25.25 0 0011.396 7H4.604a.25.25 0 00-.177.427z"})})]}),g&&(0,a.jsx)("div",{className:"absolute top-full left-0 right-0 mt-1 rounded-lg border shadow-2xl z-10 max-h-60 overflow-y-auto",style:{backgroundColor:"var(--secondary-bg, #161b22)",borderColor:"var(--border, #30363d)"},children:o.map(e=>(0,a.jsxs)("div",{onClick:()=>k(e.id),className:"flex items-center gap-3 px-4 py-3 cursor-pointer transition-all duration-150 first:rounded-t-lg last:rounded-b-lg",style:{backgroundColor:x.includes(e.id)?"var(--overlay-light, rgba(88, 166, 255, 0.1))":"transparent"},onMouseEnter:t=>{x.includes(e.id)||(t.target.style.backgroundColor="var(--active-bg, #1c2128)")},onMouseLeave:t=>{x.includes(e.id)||(t.target.style.backgroundColor="transparent")},children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium",style:{backgroundColor:x.includes(e.id)?"var(--gradient-blue, #58a6ff)":"var(--tertiary-bg, #21262d)",color:x.includes(e.id)?"white":"var(--text-secondary, #7d8590)"},children:e.firstname[0]+e.lastname[0]}),(0,a.jsx)("span",{className:"flex-1 text-sm",style:{color:"var(--text-primary, #e6edf3)"},children:e.firstname}),x.includes(e.id)&&(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",style:{color:"var(--gradient-blue, #58a6ff)"},children:(0,a.jsx)("path",{d:"M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"})})]},e.id))})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"flex-1 py-3 px-4 rounded-lg border font-medium text-sm transition-all duration-200 hover:scale-[1.02]",style:{backgroundColor:"var(--tertiary-bg, #21262d)",borderColor:"var(--border, #30363d)",color:"var(--text-secondary, #7d8590)"},onMouseEnter:e=>{e.target.style.backgroundColor="var(--active-bg, #1c2128)"},onMouseLeave:e=>{e.target.style.backgroundColor="var(--tertiary-bg, #21262d)"},disabled:p,children:"Cancel"}),(0,a.jsxs)("button",{type:"submit",disabled:!u.trim()||0===x.length||p,className:"flex-1 py-3 px-4 rounded-lg font-medium text-sm transition-all duration-200 hover:scale-[1.02] relative overflow-hidden group disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",style:{background:!u.trim()||0===x.length||p?"var(--border, #30363d)":"linear-gradient(90deg, var(--gradient-blue, #58a6ff), var(--gradient-purple, #a855f7))",color:"var(--text-white, white)",border:"none"},children:[(0,a.jsx)("span",{className:"relative z-10",children:"Create Group"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r opacity-0 group-hover:opacity-20 transition-opacity duration-200",style:{backgroundImage:"linear-gradient(90deg, var(--gradient-purple, #a855f7), var(--gradient-orange, #f97316))"}})]})]})]})]})})]})},V=e=>{let{handleClickOutside:t,onGroupUpdated:r,group:l}=e,i=d(e=>e.friends),{chats:o,updateGroupChat:u}=n(),m=null!=i?i:[],[x,h]=(0,s.useState)(l.name),[g,f]=(0,s.useState)(l.participants),[p,b]=(0,s.useState)(!1),[v,y]=(0,s.useState)(!1),[j,w]=(0,s.useState)(!1),[N,C]=(0,s.useState)(!1),[k,S]=(0,s.useState)(""),A=e=>{f(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},E=async e=>{if(console.log("Submitting group update...",l.id),e.preventDefault(),!x.trim()||g.length<2)return;console.log("Submitting group update:",x,g);let a=x.trim();if(o.some(e=>e.name===a&&e.id!==l.id)){S("A group with this name already exists."),C(!0),setTimeout(()=>C(!1),3e3);return}y(!0);try{await new Promise(e=>setTimeout(e,2e3));let e=l.participants,s=g.filter(t=>!e.includes(t)),i=e.filter(e=>!g.includes(e));await u(l.id,a,s,i),r({id:l.id,name:a,participants:g}),y(!1),w(!0),setTimeout(()=>{w(!1),t()},2e3)}catch(e){y(!1),S("Failed to update group."),C(!0),setTimeout(()=>C(!1),3e3)}},F=m.filter(e=>g.includes(e.id)).map(e=>"".concat(e.firstname," ").concat(e.lastname));return(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{backgroundColor:"rgba(13, 17, 23, 0.8)"},onClick:t,children:[j&&(0,a.jsx)(D.A,{message:"Group updated!"}),N&&(0,a.jsx)(P.A,{message:k}),v&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-70 z-50 rounded-lg",children:(0,a.jsx)(c.H5,{})}),(0,a.jsx)("div",{className:"relative w-full bg-navbar-bg border-primary border max-w-md rounded-lg shadow-2xl backdrop-blur-sm",onClick:e=>e.stopPropagation(),children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-2 bg-gradient-to-r bg-clip-text text-transparent",style:{backgroundImage:"linear-gradient(90deg, var(--gradient-blue, #58a6ff), var(--gradient-purple, #a855f7))"},children:"Update Group"}),(0,a.jsx)("p",{style:{color:"var(--text-secondary, #7d8590)"},className:"text-sm",children:"Modify group name or members"})]}),(0,a.jsxs)("form",{onSubmit:E,className:"space-y-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"groupName",className:"block text-primary text-sm font-medium mb-2",children:"Group Name *"}),(0,a.jsx)("input",{type:"text",id:"groupName",required:!0,value:x,onChange:e=>h(e.target.value),className:"w-full px-4 py-3 rounded-lg border text-sm",style:{backgroundColor:"var(--tertiary-bg, #21262d)",borderColor:"var(--border, #30363d)",color:"var(--text-primary, #e6edf3)"},onFocus:e=>{e.target.style.borderColor="var(--gradient-blue, #58a6ff)",e.target.style.boxShadow="0 0 0 3px rgba(88, 166, 255, 0.1)"},onBlur:e=>{e.target.style.borderColor="var(--border, #30363d)",e.target.style.boxShadow="none"},disabled:v})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"friendsSelect",className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Group Members *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>b(!p),className:"w-full px-4 py-3 rounded-lg border text-sm text-left flex items-center justify-between",style:{backgroundColor:"var(--tertiary-bg)",borderColor:g.length>0?"var(--gradient-blue)":"var(--border)",color:"var(--text-primary)"},disabled:v,children:[(0,a.jsx)("div",{className:"flex-1",children:0===g.length?(0,a.jsx)("span",{style:{color:"var(--text-secondary)"},children:"Select friends to add..."}):(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[F.slice(0,2).map((e,t)=>(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs",style:{backgroundColor:"rgba(88, 166, 255, 0.1)",color:"var(--gradient-blue)"},children:e},t)),g.length>2&&(0,a.jsxs)("span",{className:"px-2 py-1 rounded text-xs",style:{backgroundColor:"rgba(168, 85, 247, 0.1)",color:"var(--gradient-purple)"},children:["+",g.length-2," more"]})]})}),(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",className:"transition-transform duration-200 ".concat(p?"rotate-180":""),style:{color:"var(--text-secondary)"},children:(0,a.jsx)("path",{d:"M4.427 7.427l3.396 3.396a.25.25 0 00.354 0l3.396-3.396A.25.25 0 0011.396 7H4.604a.25.25 0 00-.177.427z"})})]}),p&&(0,a.jsx)("div",{className:"absolute top-full left-0 right-0 mt-1 rounded-lg border shadow-2xl z-[1000] max-h-60 overflow-y-auto",style:{backgroundColor:"var(--secondary-bg, #161b22)",borderColor:"var(--border, #30363d)"},children:m.map(e=>(0,a.jsxs)("div",{onClick:()=>A(e.id),className:"flex items-center gap-3 px-4 py-3 cursor-pointer transition-all",style:{backgroundColor:g.includes(e.id)?"rgba(88, 166, 255, 0.1)":"transparent"},children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium",style:{backgroundColor:g.includes(e.id)?"var(--gradient-blue)":"var(--tertiary-bg)",color:g.includes(e.id)?"white":"var(--text-secondary)"},children:e.firstname[0]+e.lastname[0]}),(0,a.jsx)("span",{className:"flex-1 text-sm",style:{color:"var(--text-primary)"},children:e.firstname}),g.includes(e.id)&&(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",style:{color:"var(--gradient-blue)"},children:(0,a.jsx)("path",{d:"M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"})})]},e.id))})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"flex-1 py-3 px-4 rounded-lg border font-medium text-sm",style:{backgroundColor:"var(--tertiary-bg)",borderColor:"var(--border)",color:"var(--text-secondary)"},children:"Cancel"}),(0,a.jsxs)("button",{type:"submit",disabled:!x.trim()||g.length<2||v,className:"flex-1 py-3 px-4 rounded-lg font-medium text-sm relative overflow-hidden group",style:{background:!x.trim()||g.length<2||v?"var(--border)":"linear-gradient(90deg, var(--gradient-blue), var(--gradient-purple))",color:"white",border:"none",opacity:v?.5:1,cursor:v?"not-allowed":"pointer"},children:[(0,a.jsx)("span",{className:"relative z-10",children:"Update Group"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r opacity-0 group-hover:opacity-20 transition-opacity duration-200",style:{backgroundImage:"linear-gradient(90deg, var(--gradient-purple), var(--gradient-orange))"}})]})]})]})]})})]})};var W=r(313);let Y=e=>{let{chat:t,handleClickOutside:r}=e,[l,i]=(0,s.useState)(!1),[n,c]=(0,s.useState)(null),u=t.name.split(" ").map(e=>e[0]).join("").toUpperCase(),{user:m}=(0,o.n)(),{fetchFriendDetails:x}=d(),h=t.participants.find(e=>e!==(null==m?void 0:m.id));return((0,s.useEffect)(()=>{(async()=>{if(h)try{let e=await x(h);c(e)}catch(e){console.error("Failed to fetch friend details",e)}})()},[h]),n)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{onClick:r,className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{backgroundColor:"rgba(13, 17, 23, 0.8)"},children:(0,a.jsxs)("div",{className:"relative w-auto bg-navbar-bg border-primary border max-w-md p-4 backdrop-blur-sm rounded-lg shadow-lg flex flex-col items-center",children:[(0,a.jsx)("div",{className:"w-20 h-20 mx-auto rounded-full overflow-hidden cursor-pointer border-2 border-blue-400 relative",onClick:()=>i(!0),children:n.profilePicture?(0,a.jsx)(y.default,{src:n.profilePicture,alt:n.firstname,width:80,height:80,className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-r from-purple-500 to-pink-500 text-white text-2xl font-bold",children:u})}),(0,a.jsxs)("div",{className:"mt-2 text-white text-sm font-semibold",children:[n.firstname," ",n.lastname]}),(0,a.jsx)("div",{className:"mt-1 text-gray-400 text-sm",children:n.email})]})}),(0,a.jsxs)(W.lG,{open:l,onClose:()=>i(!1),className:"relative z-50",children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black/70","aria-hidden":"true"}),(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,a.jsxs)(W.lG.Panel,{className:"bg-[#0d1117] p-4 rounded-lg border border-primary max-w-md w-full",children:[(0,a.jsx)("div",{className:"text-right mb-2",children:(0,a.jsx)("button",{onClick:()=>i(!1),className:"text-sm text-gray-400 hover:text-white",children:"Close"})}),n.profilePicture?(0,a.jsx)(y.default,{src:n.profilePicture,alt:"".concat(n.firstname,"'s profile"),width:400,height:400,className:"w-full h-auto rounded"}):(0,a.jsx)("div",{className:"w-full h-64 flex items-center justify-center bg-gradient-to-r from-purple-500 to-pink-500 text-white text-4xl font-bold rounded",children:u})]})})]})]}):null},q=e=>{let{isOpen:t,handleClose:r,showCreateGroup:s,handleClickOutside:l,showUpdateGroup:i,updateGroupChat:n,handleGroupUpdated:o,showFriendProfile:d}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"".concat(t?"flex":"hidden"," fixed inset-0 z-[1000] bg-navbar-bg flex-col  items-center justify-center overflow-auto"),children:[(0,a.jsx)("button",{onClick:r,className:"text-primary text-3xl font-bold hover:text-red-500 transition-colors p-2","aria-label":"Close",children:"\xd7"}),(0,a.jsx)(_,{})]}),(0,a.jsx)("div",{className:"".concat(s?"block":"hidden"," absolute top-0 bottom-0 left-0 right-0 flex justify-center items-center h-full border p-4 md:p-8 z-[100]"),children:(0,a.jsx)(H,{handleClickOutside:l})}),(0,a.jsx)("div",{className:"".concat(i?"block":"hidden"," absolute top-0 bottom-0 left-0 right-0 flex justify-center items-center h-full border p-4 md:p-8 z-[100]"),children:n&&(0,a.jsx)(V,{handleClickOutside:l,onGroupUpdated:o,group:{id:n.id,name:n.name,participants:n.participants.map(e=>e.id)}})}),(0,a.jsx)("div",{className:"".concat(d?"block":"hidden"," absolute top-0 bottom-0 left-0 right-0 flex justify-center items-center h-full border p-4 md:p-8 z-[100]"),children:n&&(0,a.jsx)(Y,{chat:{id:n.id,name:n.name,participants:n.participants.map(e=>e.id)},handleClickOutside:l})})]})},K=()=>{let[e,t]=(0,s.useState)(!1),[r,l]=(0,s.useState)(null),[i,u]=(0,s.useState)(!1),[m,x]=(0,s.useState)(!1),[h,g]=(0,s.useState)(!1),[f,p]=(0,s.useState)(null),{isAuthenticated:b,getSession:v}=(0,o.n)(),{chats:y,fetchChatsSummary:j}=n(),[w,N]=(0,s.useState)(!0),[C,k]=(0,s.useState)("redirecting"),{fetchFriends:S,fetchOnlineFriends:A,fetchAllUsers:E}=d();(0,s.useEffect)(()=>{(async()=>{await v()})()},[v]),(0,s.useEffect)(()=>{if(b){k("redirecting");let e=setTimeout(()=>{k("authenticating")},2500),t=setTimeout(()=>{N(!1)},5e3);return()=>{clearTimeout(e),clearTimeout(t)}}N(!1)},[b]),(0,s.useEffect)(()=>{E(),S(),j(),A()},[E,S,A,j]);let F=()=>t(!0),M=async(e,t)=>{var r,a;if(t)return void l(t);let s=y.find(t=>Number(t.id)===e)||null;if(!s||!Array.isArray(s.participants))return void l(null);l({...s,participants:s.participants.map(e=>{var t;return{id:e.id,name:null!=(t=e.name)?t:""}}),lastMessage:null!=(r=s.lastMessage)?r:void 0,lastMessageAt:null!=(a=s.lastMessageAt)?a:void 0})},L=()=>{u(!i)},U=e=>{(null==e?void 0:e.isGroup)?(p(e),x(!m)):(g(!h),p(e))},z=()=>l(null);return w?(0,a.jsxs)("div",{className:"h-screen bg-navbar-bg flex flex-col justify-center items-center gap-4 ",children:[(0,a.jsx)(c.H5,{}),(0,a.jsx)("p",{className:"text-lg font-semibold text-primary",children:"redirecting"===C?"redirecting...":"Authenticating..."}),(0,a.jsx)("div",{className:"w-64 h-2 bg-gray-300 rounded-full overflow-hidden mt-2",children:(0,a.jsx)("div",{className:"h-full bg-gradient-to-r from-blue-400 to-purple-600 animate-progressBar",style:{animationDuration:"5s"}})})]}):(0,a.jsxs)("div",{className:"h-screen overflow-hidden ",children:[(0,a.jsx)(R,{selectedChat:r,handleUpdateOpen:U,handleBack:z,handleGroup:L,handleChatSelect:M,handleClick:F}),(0,a.jsx)(I,{selectedChat:r,handleUpdateOpen:U,handleBack:z,handleGroup:L,handleChatSelect:M,handleClick:F}),(0,a.jsx)(q,{isOpen:e,handleClose:()=>t(!1),showCreateGroup:i,handleClickOutside:()=>{u(!1),x(!1),g(!1)},showUpdateGroup:m,updateGroupChat:f,handleGroupUpdated:e=>{l(t=>t&&t.id===e.id?{...t,name:e.name,participants:e.participants.map(e=>t.participants.find(t=>t.id===e)||{id:e,name:""})}:t)},showFriendProfile:h})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[655,298,209,441,684,358],()=>t(3328)),_N_E=e.O()}]);